<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NIST CSF 2.0 – Questionnaire</title>

    <!-- Tailwind -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
    />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
      }
    </style>

    <!-- React & ReactDOM -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>

    <!-- PropTypes requis par Recharts 1.x -->
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>

    <!-- Recharts UMD -->
    <script src="https://unpkg.com/recharts@1.6.2/umd/Recharts.min.js"></script>

    <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- htm (JSX-like sans build) -->
    <script src="https://unpkg.com/htm@3.1.1/dist/htm.umd.js"></script>
  </head>

  <body class="bg-neutral-50">
    <div id="root"></div>

    <script>
      const { useState, useEffect, useMemo, useCallback, useRef } = React;
      const html = window.htm.bind(React.createElement);

      const {
        BarChart,
        Bar,
        XAxis,
        YAxis,
        CartesianGrid,
        Tooltip,
        ResponsiveContainer,
        Radar: RadarShape,
        RadarChart: RChart,
        PolarGrid,
        PolarAngleAxis,
        PolarRadiusAxis,
        Legend,
        Cell,
      } = Recharts;

      // ------------------ Données de base ------------------

      const FUNCTIONS = [
        { id: "GOVERN", fr: "Gouverner", en: "Govern" },
        { id: "IDENTIFY", fr: "Identifier", en: "Identify" },
        { id: "PROTECT", fr: "Protéger", en: "Protect" },
        { id: "DETECT", fr: "Détecter", en: "Detect" },
        { id: "RESPOND", fr: "Répondre", en: "Respond" },
        { id: "RECOVER", fr: "Rétablir", en: "Recover" },
      ];

      const DEPARTMENTS = [
        { id: "CEO", fr: "CEO", en: "CEO" },
        { id: "COO", fr: "COO", en: "COO" },
        { id: "CIO", fr: "CIO", en: "CIO" },
        { id: "CISO", fr: "CISO", en: "CISO" },
        {
          id: "CHIEF_RISK_OFFICER",
          fr: "Chief Risk Officer",
          en: "Chief Risk Officer",
        },
        { id: "RISK_MANAGER", fr: "Risk Manager", en: "Risk Manager" },
        {
          id: "COMPLIANCE_OFFICER",
          fr: "Compliance Officer",
          en: "Compliance Officer",
        },
        {
          id: "DATA_PROTECTION_OFFICER",
          fr: "Data Protection Officer",
          en: "Data Protection Officer",
        },
        {
          id: "INTERNAL_AUDITOR",
          fr: "Internal Auditor",
          en: "Internal Auditor",
        },
        {
          id: "GOVERNANCE_LEAD",
          fr: "Governance Lead",
          en: "Governance Lead",
        },
        { id: "HR_MANAGER", fr: "HR Manager", en: "HR Manager" },
        {
          id: "LEARNING_DEVELOPMENT",
          fr: "Learning & Development",
          en: "Learning & Development",
        },
        {
          id: "LEGAL_COUNSEL",
          fr: "Legal Counsel",
          en: "Legal Counsel",
        },
        {
          id: "COMMUNICATIONS_MANAGER",
          fr: "Communications Manager",
          en: "Communications Manager",
        },
        {
          id: "VENDOR_MANAGER",
          fr: "Vendor Manager",
          en: "Vendor Manager",
        },
        {
          id: "ENTERPRISE_ARCHITECT",
          fr: "Enterprise Architect",
          en: "Enterprise Architect",
        },
        {
          id: "BUSINESS_CONTINUITY_MANAGER",
          fr: "Business Continuity Manager",
          en: "Business Continuity Manager",
        },
        {
          id: "DISASTER_RECOVERY_LEAD",
          fr: "Disaster Recovery Lead",
          en: "Disaster Recovery Lead",
        },
        {
          id: "SYSTEM_ADMINISTRATOR",
          fr: "System Administrator",
          en: "System Administrator",
        },
        {
          id: "NETWORK_ADMINISTRATOR",
          fr: "Network Administrator",
          en: "Network Administrator",
        },
        {
          id: "CLOUD_ENGINEER",
          fr: "Cloud Engineer",
          en: "Cloud Engineer",
        },
        {
          id: "DATABASE_ADMINISTRATOR",
          fr: "Database Administrator",
          en: "Database Administrator",
        },
        {
          id: "SECURITY_ENGINEER",
          fr: "Security Engineer",
          en: "Security Engineer",
        },
        {
          id: "DEVSECOPS_ENGINEER",
          fr: "DevSecOps Engineer",
          en: "DevSecOps Engineer",
        },
        {
          id: "SECURITY_ARCHITECT",
          fr: "Security Architect",
          en: "Security Architect",
        },
        { id: "IAM_MANAGER", fr: "IAM Manager", en: "IAM Manager" },
        { id: "IAM_ANALYST", fr: "IAM Analyst", en: "IAM Analyst" },
        {
          id: "CYBERSECURITY_ANALYST",
          fr: "Cybersecurity Analyst",
          en: "Cybersecurity Analyst",
        },
      ];

      const DEPARTMENT_LOOKUP = DEPARTMENTS.reduce((map, dept) => {
        map[dept.id] = dept;
        return map;
      }, {});

      const ALL_DEPARTMENT_IDS = DEPARTMENTS.map((dept) => dept.id);

      const CATEGORY_DEPARTMENT_MAP = {
        "GV.OC": [
          "CEO",
          "COO",
          "CIO",
          "GOVERNANCE_LEAD",
        ],
        "GV.RM": [
          "CHIEF_RISK_OFFICER",
          "RISK_MANAGER",
          "CISO",
        ],
        "GV.RR": ["CEO", "COO", "GOVERNANCE_LEAD", "HR_MANAGER"],
        "GV.PO": [
          "COMPLIANCE_OFFICER",
          "LEGAL_COUNSEL",
          "GOVERNANCE_LEAD",
        ],
        "GV.OV": ["INTERNAL_AUDITOR", "COMPLIANCE_OFFICER", "CEO"],
        "GV.SC": ["VENDOR_MANAGER", "LEGAL_COUNSEL", "COO"],
        "ID.AM": [
          "CIO",
          "SYSTEM_ADMINISTRATOR",
          "NETWORK_ADMINISTRATOR",
          "CLOUD_ENGINEER",
          "DATABASE_ADMINISTRATOR",
        ],
        "ID.BE": ["CEO", "COO", "BUSINESS_CONTINUITY_MANAGER"],
        "ID.IM": [
          "ENTERPRISE_ARCHITECT",
          "CIO",
          "SECURITY_ARCHITECT",
        ],
        "ID.RA": [
          "CHIEF_RISK_OFFICER",
          "RISK_MANAGER",
          "CYBERSECURITY_ANALYST",
        ],
        "ID.RM": ["CHIEF_RISK_OFFICER", "RISK_MANAGER", "CEO"],
        "ID.SC": ["VENDOR_MANAGER", "LEGAL_COUNSEL", "CYBERSECURITY_ANALYST"],
        "PR.AA": ["IAM_MANAGER", "IAM_ANALYST", "SECURITY_ARCHITECT"],
        "PR.AT": [
          "HR_MANAGER",
          "LEARNING_DEVELOPMENT",
          "COMMUNICATIONS_MANAGER",
        ],
        "PR.DS": [
          "DATA_PROTECTION_OFFICER",
          "DATABASE_ADMINISTRATOR",
          "SECURITY_ENGINEER",
        ],
        "PR.MA": [
          "SYSTEM_ADMINISTRATOR",
          "NETWORK_ADMINISTRATOR",
          "CLOUD_ENGINEER",
          "DEVSECOPS_ENGINEER",
        ],
        "PR.PS": [
          "SECURITY_ARCHITECT",
          "SECURITY_ENGINEER",
          "DEVSECOPS_ENGINEER",
          "ENTERPRISE_ARCHITECT",
        ],
        "PR.IR": [
          "BUSINESS_CONTINUITY_MANAGER",
          "DISASTER_RECOVERY_LEAD",
          "CIO",
        ],
        "DE.AE": [
          "CYBERSECURITY_ANALYST",
          "SECURITY_ENGINEER",
          "NETWORK_ADMINISTRATOR",
        ],
        "DE.CM": [
          "CYBERSECURITY_ANALYST",
          "SECURITY_ENGINEER",
          "DEVSECOPS_ENGINEER",
        ],
        "DE.DP": [
          "CYBERSECURITY_ANALYST",
          "SECURITY_ARCHITECT",
          "CISO",
        ],
        "RS.RP": [
          "CISO",
          "BUSINESS_CONTINUITY_MANAGER",
          "DISASTER_RECOVERY_LEAD",
        ],
        "RS.CO": ["COMMUNICATIONS_MANAGER", "CEO", "LEGAL_COUNSEL"],
        "RS.AN": ["CYBERSECURITY_ANALYST", "SECURITY_ENGINEER", "CISO"],
        "RS.MI": [
          "SECURITY_ENGINEER",
          "DEVSECOPS_ENGINEER",
          "SYSTEM_ADMINISTRATOR",
        ],
        "RS.IM": ["CISO", "CHIEF_RISK_OFFICER", "SECURITY_ARCHITECT"],
        "RS.RR": ["CEO", "INTERNAL_AUDITOR", "COMPLIANCE_OFFICER"],
        "RC.RP": [
          "BUSINESS_CONTINUITY_MANAGER",
          "DISASTER_RECOVERY_LEAD",
          "CIO",
        ],
        "RC.IM": ["CIO", "CISO", "CHIEF_RISK_OFFICER"],
        "RC.CO": ["COMMUNICATIONS_MANAGER", "CEO", "LEGAL_COUNSEL"],
      };

      const QUESTIONS = [
        {
          id: "GV.OC-01",
          fn: "GOVERN",
          category: "GV.OC",
          fr: "La mission, les objectifs et les parties prenantes de l’organisation sont-ils connus et utilisés pour guider les décisions de gestion du risque cyber ?",
          en: "Are the organization’s mission, objectives, and stakeholders understood and used to guide cybersecurity risk management decisions?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question vérifie que la direction cartographie la mission, les objectifs stratégiques, les parties prenantes et les activités critiques pour éclairer les arbitrages de cybersécurité. Informations complémentaires : rechercher des documents de planification stratégique, une cartographie des parties prenantes ou un registre d’alignement cyber/business mis à jour.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Partager la mission de l’organisation (p. ex., via les énoncés de vision et de mission, les stratégies marketing et de services) afin de disposer d’une base pour identifier les risques susceptibles d’entraver cette mission.<br /><br /><strong>Exemples de documentations nécessaires :</strong> plan stratégique d’entreprise, énoncé de mission et de vision, cartographie des processus et actifs critiques, registre des parties prenantes, registre d’alignement cyber/business ou tableaux de bord de gouvernance intégrant des indicateurs cyber.",
          detailEn:
            "<strong>Detailed description:</strong> This item confirms leadership maps the mission, strategic objectives, stakeholders, and critical activities so cybersecurity tradeoffs align with business priorities. Additional guidance: look for strategic plans, stakeholder maps, or an updated cybersecurity-to-business alignment register.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Share the organization's mission (e.g., through vision and mission statements, marketing, and service strategies) to provide a basis for identifying risks that may impede that mission.<br /><br /><strong>Supporting documentation examples:</strong> corporate strategic plan, mission and vision statement, critical process and asset map, stakeholder register, cybersecurity-to-business alignment log, or governance dashboards featuring cyber indicators.",
        },
        {
          id: "GV.OC-02",
          fn: "GOVERN",
          category: "GV.OC",
          fr: "Les rôles dans l’écosystème (fournisseurs, partenaires, parties prenantes externes) et les dépendances associées sont-ils identifiés pour éclairer les décisions de cybersécurité ?",
          en: "Are ecosystem roles (suppliers, partners, external stakeholders) and related dependencies identified to inform cybersecurity decisions?",
          detailFr:
            "<strong>Description détaillée :</strong> Le contrôle s’assure que l’organisation connaît les relations critiques de sa chaîne de valeur et les dépendances externes qui influencent la gestion du risque cyber. Informations complémentaires : vérifier la présence d’une cartographie des fournisseurs critiques, d’accords de niveaux de service incluant des exigences cyber ou d’analyses d’impact supply chain.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Identifier les parties prenantes internes pertinentes et leurs attentes liées à la cybersécurité (p. ex., attentes de performance et de risque des dirigeants, attentes culturelles des employés).<br /><strong>Ex2 :</strong> Identifier les parties prenantes externes pertinentes et leurs attentes liées à la cybersécurité (p. ex., attentes de confidentialité des clients, attentes commerciales des partenaires, attentes de conformité des régulateurs, attentes éthiques de la société).<br /><br /><strong>Exemples de documentations nécessaires :</strong> cartographie de la chaîne d’approvisionnement, registre des fournisseurs et partenaires critiques, SLA ou contrats avec clauses cyber, analyses d’impact supply chain, comptes rendus de comité de gouvernance écosystème.",
          detailEn:
            "<strong>Detailed description:</strong> This control ensures the organization understands critical value-chain relationships and external dependencies that shape cybersecurity risk management. Additional guidance: check for critical supplier maps, service-level agreements with security clauses, or supply-chain impact analyses.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Identify relevant internal stakeholders and their cybersecurity-related expectations (e.g., performance and risk expectations of officers, directors, and advisors; cultural expectations of employees).<br /><strong>Ex2:</strong> Identify relevant external stakeholders and their cybersecurity-related expectations (e.g., privacy expectations of customers, business expectations of partnerships, compliance expectations of regulators, ethics expectations of society).<br /><br /><strong>Supporting documentation examples:</strong> supply-chain mapping, critical third-party inventory, SLAs or contracts including cybersecurity clauses, supply-chain impact assessments, and governance committee minutes covering ecosystem dependencies.",
        },
        {
          id: "GV.OC-03",
          fn: "GOVERN",
          category: "GV.OC",
          fr: "Les exigences juridiques, réglementaires et contractuelles en matière de cybersécurité, de protection des données et de confidentialité sont-elles connues et intégrées dans la gestion des risques ?",
          en: "Are legal, regulatory, and contractual requirements for cybersecurity, data protection, and privacy understood and integrated into risk management?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question confirme que l’organisation recense et suit les obligations externes affectant la cybersécurité pour orienter les contrôles et priorités. Informations complémentaires : consulter un registre de conformité, les rapports de veille réglementaire ou les matrices d’obligations contractuelles.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Déterminer un processus pour suivre et gérer les exigences légales et réglementaires relatives à la protection des informations des individus (p. ex., HIPAA, CCPA, RGPD).<br /><strong>Ex2 :</strong> Déterminer un processus pour suivre et gérer les exigences contractuelles pour la gestion de la cybersécurité des informations des fournisseurs, clients et partenaires.<br /><strong>Ex3 :</strong> Aligner la stratégie de cybersécurité de l’organisation sur les exigences légales, réglementaires et contractuelles.<br /><br /><strong>Exemples de documentations nécessaires :</strong> registre de conformité ou matrice d’obligations, rapports de veille réglementaire, politique de protection des données, clauses contractuelles types, preuves d’audits ou de contrôles de conformité.",
          detailEn:
            "<strong>Detailed description:</strong> This question confirms the organization catalogs and tracks external obligations impacting cybersecurity to steer controls and priorities. Additional guidance: look for compliance registers, regulatory watch reports, or matrices of contractual obligations.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Determine a process to track and manage legal and regulatory requirements regarding protection of individuals’ information (e.g., HIPAA, CCPA, GDPR).<br /><strong>Ex2:</strong> Determine a process to track and manage contractual requirements for cybersecurity management of supplier, customer, and partner information.<br /><strong>Ex3:</strong> Align the organization’s cybersecurity strategy with legal, regulatory, and contractual requirements.<br /><br /><strong>Supporting documentation examples:</strong> compliance register or obligation matrix, regulatory watch reports, data protection policy, standard contractual clauses, and audit or compliance review evidence.",
        },
        {
          id: "GV.OC-04",
          fn: "GOVERN",
          category: "GV.OC",
          fr: "Les services et capacités critiques, ainsi que leurs dépendances, sont-ils identifiés et priorisés pour supporter la gestion du risque cyber ?",
          en: "Are critical services and capabilities, along with their dependencies, identified and prioritized to support cybersecurity risk management?",
          detailFr:
            "<strong>Description détaillée :</strong> Le contrôle vérifie que l’organisation connaît les services essentiels et leurs dépendances technologiques ou opérationnelles pour cibler les efforts de protection. Informations complémentaires : analyser les analyses d’impact sur l’activité (BIA), les cartographies d’architectures critiques ou les registres de dépendances.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Établir des critères pour déterminer la criticité des capacités et services de l’organisation tels que perçus par les parties prenantes internes et externes.<br /><strong>Ex2 :</strong> Déterminer (p. ex., via une analyse d’impact sur l’activité) les actifs et opérations métiers vitaux pour atteindre les objectifs de mission et l’impact de leur perte.<br /><strong>Ex3 :</strong> Définir et communiquer des objectifs de résilience (p. ex., RTO) pour délivrer les capacités critiques dans différents états de fonctionnement.<br /><br /><strong>Exemples de documentations nécessaires :</strong> analyses d’impact sur l’activité (BIA), cartographies d’architecture critiques, registres des dépendances techniques et métiers, fiches de services critiques, matrices services-actifs-propriétaires.",
          detailEn:
            "<strong>Detailed description:</strong> This control checks that the organization understands essential services and their technological or operational dependencies to target protection efforts. Additional guidance: review business impact analyses, critical architecture maps, or dependency registers.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Establish criteria for determining the criticality of the organization’s capabilities and services as viewed by internal and external stakeholders.<br /><strong>Ex2:</strong> Determine (e.g., from a business impact analysis) assets and business operations vital to achieving mission objectives and the impact of their loss.<br /><strong>Ex3:</strong> Establish and communicate resilience objectives (e.g., RTOs) for delivering critical capabilities in various operating states.<br /><br /><strong>Supporting documentation examples:</strong> business impact analyses, critical architecture diagrams, dependency registers, critical service profiles, and matrices connecting services to assets and owners.",
        },
        {
          id: "GV.OC-05",
          fn: "GOVERN",
          category: "GV.OC",
          fr: "Des exigences de résilience sont-elles définies pour soutenir la prestation des services critiques identifiés ?",
          en: "Are resilience requirements defined to support delivery of the identified critical services?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question s’assure que les niveaux de résilience attendus (RTO/RPO, tolérance aux pannes, scénarios de continuité) sont établis pour chaque service critique. Informations complémentaires : examiner les stratégies de continuité, les plans de reprise ou les objectifs de disponibilité approuvés.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Créer un inventaire des dépendances de l’organisation vis-à-vis des ressources externes (p. ex., installations, fournisseurs d’hébergement cloud) et de leur relation avec les actifs/fonctions métiers.<br /><strong>Ex2 :</strong> Identifier et documenter les dépendances externes susceptibles de constituer des points de défaillance pour les services critiques et les communiquer en interne.<br /><br /><strong>Exemples de documentations nécessaires :</strong> stratégie de continuité d’activité, plans de reprise et de continuité validés, fiches de services avec RTO/RPO, rapports de tests de continuité, clauses de résilience dans les contrats fournisseurs ou procédures de gestion des changements.",
          detailEn:
            "<strong>Detailed description:</strong> This question ensures expected resilience levels (RTO/RPO, fault tolerance, continuity scenarios) are defined for each critical service. Additional guidance: review continuity strategies, recovery plans, or approved availability objectives.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Create an inventory of the organization’s dependencies on external resources (e.g., facilities, cloud hosting providers) and their relationship to assets/business functions.<br /><strong>Ex2:</strong> Identify and document external dependencies that are potential points of failure for critical services and communicate them internally.<br /><br /><strong>Supporting documentation examples:</strong> business continuity strategies, approved recovery and continuity plans, service profiles with RTO/RPO targets, continuity test reports, and supplier contracts or change procedures embedding resilience requirements.",
        },
        {
          id: "GV.RM-01",
          fn: "GOVERN",
          category: "GV.RM",
          fr: "Les objectifs de gestion du risque cybersécurité sont-ils définis, mesurables et validés par les parties prenantes organisationnelles ?",
          en: "Are cybersecurity risk management objectives defined, measurable, and endorsed by organizational stakeholders?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question vérifie que l’organisation formalise des objectifs de gestion du risque cyber alignés sur la mission et approuvés par les dirigeants clés (comité exécutif, métiers, fonctions support). Informations complémentaires : confirmer la présence d’une charte ou stratégie de gestion du risque précisant les attentes, indicateurs et délais.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Actualiser les objectifs de gestion du risque cyber à court et long terme lors de la planification stratégique.<br /><strong>Ex2 :</strong> Définir des objectifs mesurables pour la gestion du risque cyber.<br /><strong>Ex3 :</strong> Faire approuver ces objectifs par les dirigeants et les utiliser pour mesurer et piloter le risque.<br /><br /><strong>Exemples de documentations nécessaires :</strong> stratégie ou charte de gestion du risque cyber, procès-verbaux de comités validant les objectifs, tableaux de bord consolidant les KRI et suivi des objectifs, plan directeur cybersécurité aligné sur la stratégie d’entreprise.",
          detailEn:
            "<strong>Detailed description:</strong> Confirm the organization formalizes cybersecurity risk management objectives that align with its mission and receive endorsement from key leaders (executive committee, business units, enabling functions). Additional guidance: look for a risk management charter or strategy that specifies expectations, indicators, and timeframes.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Update near- and long-term cybersecurity risk management objectives as part of strategic planning.<br /><strong>Ex2:</strong> Establish measurable objectives for cybersecurity risk management.<br /><strong>Ex3:</strong> Senior leaders agree on cybersecurity objectives and use them for measuring and managing risk.<br /><br /><strong>Supporting documentation examples:</strong> cybersecurity risk management strategy or charter, committee minutes approving objectives, dashboards consolidating KRIs and progress, and a cybersecurity master plan aligned with enterprise strategy.",
        },
        {
          id: "GV.RM-02",
          fn: "GOVERN",
          category: "GV.RM",
          fr: "Les déclarations d’appétence et de tolérance au risque cyber sont-elles formalisées, approuvées et communiquées à l’ensemble des parties prenantes ?",
          en: "Are cybersecurity risk appetite and tolerance statements formalized, approved, and communicated to all relevant stakeholders?",
          detailFr:
            "<strong>Description détaillée :</strong> Le contrôle confirme que l’organisation définit des seuils chiffrés ou qualitatifs décrivant le niveau de risque acceptable et les conditions d’escalade. Informations complémentaires : identifier les liens entre appétence au risque, décisions d’investissement et limites opérationnelles.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Déterminer et communiquer les déclarations d’appétence au risque.<br /><strong>Ex2 :</strong> Traduire l’appétence en seuils de tolérance mesurables et compréhensibles.<br /><strong>Ex3 :</strong> Actualiser périodiquement les objectifs et l’appétence en fonction de l’exposition et du risque résiduel.<br /><br /><strong>Exemples de documentations nécessaires :</strong> déclaration d’appétence et de tolérance au risque, procès-verbaux du conseil ou du comité d’audit, guides de décision ou matrices d’escalade, supports de communication ou de formation diffusant les seuils de risque.",
          detailEn:
            "<strong>Detailed description:</strong> This item ensures the organization defines quantitative or qualitative thresholds describing acceptable cyber risk levels and escalation triggers. Additional guidance: verify connections between risk appetite, investment decisions, and operational limits.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Determine and communicate cybersecurity risk appetite statements.<br /><strong>Ex2:</strong> Translate risk appetite into measurable, understandable tolerance statements.<br /><strong>Ex3:</strong> Refine objectives and risk appetite periodically based on exposure and residual risk.<br /><br /><strong>Supporting documentation examples:</strong> risk appetite and tolerance statement, board or audit committee minutes, decision guides or escalation matrices, and communication or training materials that disseminate risk thresholds.",
        },
        {
          id: "GV.RM-03",
          fn: "GOVERN",
          category: "GV.RM",
          fr: "Les critères d’identification, d’évaluation et de priorisation des risques cyber sont-ils définis, cohérents et appliqués ?",
          en: "Are criteria for identifying, evaluating, and prioritizing cyber risks defined, consistent, and applied?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question s’assure que la méthodologie d’analyse de risques précise les catégories, échelles d’impact/probabilité et règles de priorisation utilisées dans toute l’organisation. Informations complémentaires : vérifier la cohérence des outils (registres, matrices) et leur alignement avec la stratégie de gestion des risques.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Agréger et piloter les risques cybers avec les autres risques d’entreprise (opérationnels, financiers, réglementaires, etc.).<br /><strong>Ex2 :</strong> Inclure les responsables du risque cyber dans la planification ERM.<br /><strong>Ex3 :</strong> Définir des critères d’escalade pour les risques cybers.<br /><br /><strong>Exemples de documentations nécessaires :</strong> méthodologie ou guide d’évaluation des risques, matrices d’impact/probabilité, registres de risques illustrant l’application des critères, preuves de revues d’harmonisation (comptes rendus, rapports de qualité des données).",
          detailEn:
            "<strong>Detailed description:</strong> Verify the risk analysis methodology defines categories, impact/likelihood scales, and prioritization rules that are applied consistently across the organization. Additional guidance: confirm supporting tools (registers, matrices) are aligned with the stated risk management strategy.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Aggregate and manage cybersecurity risks with other enterprise risks (operational, financial, regulatory…).<br /><strong>Ex2:</strong> Include cybersecurity risk managers in ERM planning.<br /><strong>Ex3:</strong> Establish criteria for escalating cybersecurity risks.<br /><br /><strong>Supporting documentation examples:</strong> risk assessment methodology or guide, impact/likelihood matrices, risk registers showing the applied criteria, and evidence of harmonization reviews (minutes, data quality reports).",
        },
        {
          id: "GV.RM-04",
          fn: "GOVERN",
          category: "GV.RM",
          fr: "La stratégie de gestion des risques cyber est-elle intégrée au dispositif global de gestion des risques de l’entreprise et guide-t-elle les décisions de traitement ?",
          en: "Is the cybersecurity risk management strategy integrated with the organization’s enterprise risk management and used to guide risk treatment decisions?",
          detailFr:
            "<strong>Description détaillée :</strong> Le contrôle vérifie que les analyses cyber alimentent les processus globaux de gestion des risques (ERM) et que les décisions de traitement reflètent les priorités d’entreprise. Informations complémentaires : observer la circulation des informations entre comités cyber, ERM et métiers, ainsi que l’alignement avec les stratégies sectorielles.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Spécifier des critères d’acceptation ou d’évitement du risque selon la classification des données.<br /><strong>Ex2 :</strong> Déterminer si une assurance cybersécurité doit être souscrite.<br /><strong>Ex3 :</strong> Documenter les conditions associées aux modèles de responsabilité partagée (infogérance, cloud, etc.).<br /><br /><strong>Exemples de documentations nécessaires :</strong> politique ERM incluant la cybersécurité, registre de risques d’entreprise intégrant les risques cyber, comptes rendus de comités ERM/cyber, plans de traitement montrant la prise en compte des priorités business.",
          detailEn:
            "<strong>Detailed description:</strong> Confirm cybersecurity risk analyses feed into enterprise risk management (ERM) processes and that treatment decisions reflect broader business priorities. Additional guidance: observe information flow between cyber, ERM, and business committees and alignment with sector or business-unit strategies.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Specify criteria for accepting/avoiding risk per data classification.<br /><strong>Ex2:</strong> Determine whether to purchase cybersecurity insurance.<br /><strong>Ex3:</strong> Document conditions for shared responsibility models (outsourcing, cloud…).<br /><br /><strong>Supporting documentation examples:</strong> ERM policy referencing cybersecurity, enterprise risk register including cyber risks, ERM/cyber committee minutes, and treatment plans demonstrating alignment with business priorities.",
        },
        {
          id: "GV.RM-05",
          fn: "GOVERN",
          category: "GV.RM",
          fr: "La stratégie de gestion des risques cyber est-elle revue périodiquement pour intégrer les évolutions de menaces, de réglementation et de contexte organisationnel ?",
          en: "Is the cybersecurity risk management strategy reviewed periodically to incorporate changes in threats, regulations, and organizational context?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question confirme l’existence d’un cycle de revue défini pour actualiser la stratégie, tenant compte des retours d’expérience, des évolutions technologiques et des exigences réglementaires. Informations complémentaires : vérifier la fréquence des revues, la participation des parties prenantes et la traçabilité des décisions.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Définir comment informer les cadres dirigeants et la direction de la posture de cybersécurité.<br /><strong>Ex2 :</strong> Identifier la manière dont l’ensemble des départements (juridique, RH, opérations, audit interne, etc.) communiquent sur les risques.<br /><br /><strong>Exemples de documentations nécessaires :</strong> calendrier des revues stratégiques, rapports d’actualisation ou de leçons apprises, comptes rendus de comités, suivi des actions issues des revues, analyses de veille réglementaire et technologique.",
          detailEn:
            "<strong>Detailed description:</strong> Ensure a defined review cycle updates the strategy based on lessons learned, technology evolution, and regulatory requirements. Additional guidance: confirm the review cadence, stakeholder participation, and traceability of resulting decisions.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Determine how to update senior executives and management on cybersecurity posture.<br /><strong>Ex2:</strong> Identify how all departments (legal, HR, ops, internal audit) communicate about risks.<br /><br /><strong>Supporting documentation examples:</strong> strategic review schedule, update or lessons-learned reports, committee minutes, action trackers from reviews, and regulatory or technology watch analyses.",
        },
        {
          id: "GV.RM-06",
          fn: "GOVERN",
          category: "GV.RM",
          fr: "Les décisions d’investissement, de ressources et de capacités en cybersécurité sont-elles alignées sur la stratégie de gestion des risques et les priorités validées ?",
          en: "Are cybersecurity investment, resource, and capability decisions aligned with the risk management strategy and approved priorities?",
          detailFr:
            "<strong>Description détaillée :</strong> Le contrôle vérifie que la stratégie de risque sert de base aux arbitrages budgétaires et aux plans de capacités (personnes, processus, technologies). Informations complémentaires : analyser comment les analyses de risques alimentent les business cases, feuilles de route et plans de transformation.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Définir des méthodes cohérentes pour l’évaluation des risques cybers.<br /><strong>Ex2 :</strong> Standardiser les taxonomies, les méthodes de scoring et de priorisation.<br /><strong>Ex3 :</strong> Maintenir des modèles communs et des registres de risques partagés.<br /><br /><strong>Exemples de documentations nécessaires :</strong> dossiers d’investissement ou business cases référant aux analyses de risque, feuilles de route capacités/maturité, procès-verbaux de comités d’investissement, tableaux de bord de suivi budgétaire alignés sur les priorités de risque.",
          detailEn:
            "<strong>Detailed description:</strong> Confirm the risk strategy underpins budget trade-offs and capability plans covering people, processes, and technology. Additional guidance: analyze how risk assessments feed business cases, roadmaps, and transformation plans.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Define consistent methods for cybersecurity risk assessment.<br /><strong>Ex2:</strong> Standardize taxonomies, scoring, and prioritization methods.<br /><strong>Ex3:</strong> Maintain shared templates and risk registers.<br /><br /><strong>Supporting documentation examples:</strong> investment dossiers or business cases referencing risk analyses, capability or maturity roadmaps, investment committee minutes, and budget dashboards aligned with risk priorities.",
        },
        {
          id: "GV.RM-07",
          fn: "GOVERN",
          category: "GV.RM",
          fr: "Les opportunités stratégiques (risques positifs) sont-elles caractérisées et intégrées aux discussions sur le risque cyber de l’organisation ?",
          en: "Are strategic opportunities (positive risks) characterized and included in the organization’s cybersecurity risk discussions?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question vérifie que l’organisation considère les opportunités générées par la gestion du risque cyber (avantages concurrentiels, gains d’efficacité, innovation) et les incorpore aux décisions stratégiques. Informations complémentaires : vérifier la présence d’un registre des opportunités, l’analyse coûts/bénéfices et les échanges avec l’innovation ou les métiers.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Identifier les opportunités issues des réponses aux risques cybers (efficacités opérationnelles, automatisation sécurisée, avantages concurrentiels).<br /><strong>Ex2 :</strong> Documenter les impacts positifs en parallèle des évaluations de risques traditionnelles.<br /><strong>Ex3 :</strong> Inclure les opportunités cybersécurité dans les discussions stratégiques.<br /><br /><strong>Exemples de documentations nécessaires :</strong> registre de risques/opportunités, comptes rendus de comités abordant les opportunités positives, analyses de cas d’usage montrant les bénéfices sécuritaires, présentations stratégiques reliant initiatives cyber et avantages business.",
          detailEn:
            "<strong>Detailed description:</strong> Verify the organization considers opportunities created by cybersecurity risk management (competitive advantage, efficiency gains, innovation) and incorporates them into strategic decision-making. Additional guidance: look for an opportunity register, cost/benefit analyses, and collaboration with innovation or business teams.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Identify opportunities arising from cybersecurity risk responses (operational efficiencies, safer automation, competitive advantages).<br /><strong>Ex2:</strong> Document positive impacts alongside traditional risk assessments.<br /><strong>Ex3:</strong> Include cybersecurity opportunities in strategic discussions.<br /><br /><strong>Supporting documentation examples:</strong> risk/opportunity register, meeting minutes covering positive opportunities, case analyses highlighting security-driven benefits, and strategic presentations linking cyber initiatives to business advantages.",
        },
        {
          id: "GV.RR-01",
          fn: "GOVERN",
          category: "GV.RR",
          fr: "La direction de l’organisation est-elle responsable et redevable du risque cybersécurité tout en favorisant une culture éthique, consciente des risques et axée sur l’amélioration continue ?",
          en: "Is organizational leadership responsible and accountable for cybersecurity risk while fostering a risk-aware, ethical, and continually improving culture?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle confirme que les dirigeants portent explicitement la responsabilité du risque cyber, pilotent le ton éthique et encouragent des comportements proactifs pour améliorer la posture de sécurité. Informations complémentaires : vérifier la présence d’engagements formels, d’objectifs liés à la culture cyber et de mécanismes d’exemplarité managériale.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Définir les attentes de la direction concernant la stratégie cybersécurité.<br /><strong>Ex2 :</strong> Communiquer les attentes sur le comportement éthique et la culture sécurité.<br /><strong>Ex3 :</strong> Exiger des responsables qu’ils fournissent des mises à jour de la stratégie cybersécurité.<br /><br /><strong>Exemples de documentations nécessaires :</strong> chartes de gouvernance ou mandats du conseil, procès-verbaux de comités où la direction rend compte du risque cyber, communications internes des dirigeants, résultats de sondages culturels ou plans d’amélioration continue.",
          detailEn:
            "<strong>Detailed description:</strong> This control confirms leadership explicitly owns cybersecurity risk, sets the ethical tone, and encourages proactive behaviors that continually strengthen security posture. Additional guidance: look for formal accountability statements, culture-related objectives, and mechanisms demonstrating executive role modeling.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Define leadership expectations regarding cybersecurity strategy.<br /><strong>Ex2:</strong> Communicate expectations for ethical behavior and security culture.<br /><strong>Ex3:</strong> Require cybersecurity strategy updates from accountable leaders.<br /><br /><strong>Supporting documentation examples:</strong> board or governance mandates, committee minutes showing leadership reporting on cyber risk, executive communications, culture survey results, or continuous improvement plans.",
        },
        {
          id: "GV.RR-02",
          fn: "GOVERN",
          category: "GV.RR",
          fr: "Les rôles, responsabilités et autorités liés à la gestion du risque cybersécurité sont-ils établis, communiqués, compris et appliqués ?",
          en: "Are roles, responsibilities, and authorities related to cybersecurity risk management established, communicated, understood, and enforced?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question s’assure que la structure de gouvernance cyber est claire, documentée et diffusée afin que chaque acteur connaisse ses décisions et pouvoirs. Informations complémentaires : examiner les modèles RACI, descriptions de poste et supports de communication formalisant les responsabilités.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Documenter les responsabilités cybersécurité dans les politiques.<br /><strong>Ex2 :</strong> Assigner des rôles RACI pour les activités de cybersécurité.<br /><strong>Ex3 :</strong> Intégrer les responsabilités cybersécurité dans les descriptions de poste et les évaluations.<br /><br /><strong>Exemples de documentations nécessaires :</strong> chartes de comités, descriptions de postes, politiques ou procédures assignant les autorités, supports de formation ou de sensibilisation attestant de la communication et de l’appropriation.",
          detailEn:
            "<strong>Detailed description:</strong> Ensure the cybersecurity governance structure is clear, documented, and disseminated so each stakeholder understands decision rights and authorities. Additional guidance: review RACIs, role descriptions, and communications that formalize responsibilities.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Document cybersecurity responsibilities within policies.<br /><strong>Ex2:</strong> Assign RACI roles for cybersecurity activities.<br /><strong>Ex3:</strong> Include cybersecurity responsibilities in job descriptions and evaluations.<br /><br /><strong>Supporting documentation examples:</strong> committee charters, role descriptions, policies or procedures assigning authorities, and training or awareness materials evidencing communication and adoption.",
        },
        {
          id: "GV.RR-03",
          fn: "GOVERN",
          category: "GV.RR",
          fr: "Des ressources adéquates sont-elles allouées en cohérence avec la stratégie de risque cybersécurité, les rôles, les responsabilités et les politiques ?",
          en: "Are adequate resources allocated commensurate with the cybersecurity risk strategy, roles, responsibilities, and policies?",
          detailFr:
            "<strong>Description détaillée :</strong> Le contrôle vérifie que les moyens humains, financiers et technologiques suivent les orientations de gestion du risque cyber et soutiennent les responsabilités définies. Informations complémentaires : analyser le lien entre analyses de risques, budgets, plans de capacités et priorités approuvées.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Évaluer si les responsables cybersécurité disposent de l’autorité nécessaire pour agir.<br /><strong>Ex2 :</strong> Allouer les budgets et effectifs en cohérence avec la tolérance au risque.<br /><strong>Ex3 :</strong> Formaliser l’autorité permettant de prendre des décisions relatives au risque.<br /><br /><strong>Exemples de documentations nécessaires :</strong> budgets approuvés, plans d’effectifs ou de compétences, portefeuilles de projets, rapports de suivi de ressources et décisions de comités reliant les allocations aux priorités de risque.",
          detailEn:
            "<strong>Detailed description:</strong> This question confirms human, financial, and technological means align with the cybersecurity risk strategy and sustain defined responsibilities. Additional guidance: analyze how risk assessments drive budgets, capability plans, and approved priorities.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Assess whether cybersecurity leaders have authority to act.<br /><strong>Ex2:</strong> Allocate budget and staffing aligned with risk tolerance.<br /><strong>Ex3:</strong> Formalize authority to make decisions regarding risk.<br /><br /><strong>Supporting documentation examples:</strong> approved budgets, staffing or skills plans, project portfolios, resource tracking reports, and governance decisions linking allocations to risk priorities.",
        },
        {
          id: "GV.RR-04",
          fn: "GOVERN",
          category: "GV.RR",
          fr: "La cybersécurité est-elle intégrée aux pratiques de gestion des ressources humaines (recrutement, intégration, formation, performance, départs) ?",
          en: "Is cybersecurity included in human resources practices (recruitment, onboarding, training, performance, departures)?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question confirme que le cycle de vie des collaborateurs intègre systématiquement les exigences cyber pour réduire les risques humains et renforcer la culture sécurité. Informations complémentaires : vérifier la prise en compte des compétences, des vérifications d’antécédents, de la sensibilisation continue et des procédures de départ sécurisées.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Intégrer les attentes cybersécurité dans le recrutement et l’onboarding.<br /><strong>Ex2 :</strong> Réaliser des vérifications d’antécédents pour les postes sensibles.<br /><strong>Ex3 :</strong> Exiger que le personnel accuse réception des politiques lors de l’embauche et de leurs mises à jour.<br /><br /><strong>Exemples de documentations nécessaires :</strong> politiques RH intégrant la cybersécurité, supports de formation, registres de vérification d’antécédents, matrices de compétences, check-lists d’entrée/sortie et preuves de suivi des objectifs de performance cyber.",
          detailEn:
            "<strong>Detailed description:</strong> Confirm the employee lifecycle systematically embeds cybersecurity requirements to reduce human risk and reinforce security culture. Additional guidance: check for competency criteria, background checks, continuous awareness, and secure offboarding procedures.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Integrate cybersecurity expectations into hiring and onboarding.<br /><strong>Ex2:</strong> Conduct background checks for sensitive roles.<br /><strong>Ex3:</strong> Require personnel to acknowledge policies at hiring and during updates.<br /><br /><strong>Supporting documentation examples:</strong> HR policies incorporating cybersecurity, training materials, background verification logs, skills matrices, onboarding/offboarding checklists, and evidence of cyber-related performance tracking.",
        },
        {
          id: "GV.PO-01",
          fn: "GOVERN",
          category: "GV.PO",
          fr: "Les politiques encadrant la cybersécurité sont-elles établies ?",
          en: "Are policies governing cybersecurity established?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle vérifie que l’organisation définit et approuve un corpus de politiques couvrant les domaines clés de la cybersécurité, avec des responsabilités et un périmètre clairement identifiés. Informations complémentaires : rechercher une gouvernance formelle pour rédiger, valider et diffuser ces politiques auprès des parties prenantes.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Élaborer et approuver les politiques de cybersécurité.<br /><strong>Ex2 :</strong> Diffuser les politiques à l’échelle de l’organisation.<br /><strong>Ex3 :</strong> Exiger l’accusé de réception des politiques.<br /><br /><strong>Exemples de documentations nécessaires :</strong> registre des politiques cybersécurité, procès-verbaux d’approbation, communications internes annonçant les politiques, formulaires d’attestation ou de lecture.",
          detailEn:
            "<strong>Detailed description:</strong> Validate that the organization develops and approves a comprehensive set of cybersecurity policies with clear scope, ownership, and governance. Additional guidance: look for formal processes that draft, ratify, and disseminate policies to all stakeholders.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Develop and approve cybersecurity policies.<br /><strong>Ex2:</strong> Communicate policies organization-wide.<br /><strong>Ex3:</strong> Require acknowledgment of policies.<br /><br /><strong>Supporting documentation examples:</strong> cybersecurity policy register, approval meeting minutes, enterprise-wide communications, and attestation or acknowledgement forms.",
        },
        {
          id: "GV.PO-02",
          fn: "GOVERN",
          category: "GV.PO",
          fr: "Les politiques sont-elles revues et mises à jour ?",
          en: "Are policies reviewed and updated?",
          detailFr:
            "<strong>Description détaillée :</strong> La question confirme l’existence d’un cycle de revue documenté afin de s’assurer que les politiques restent pertinentes face aux changements organisationnels, réglementaires ou de menace. Informations complémentaires : analyser la fréquence des revues, la traçabilité des modifications et l’intégration des retours d’expérience.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Revoir les politiques selon un calendrier défini.<br /><strong>Ex2 :</strong> Mettre à jour les politiques après les changements majeurs de l’organisation ou du paysage de menaces.<br /><strong>Ex3 :</strong> Intégrer les leçons tirées des incidents et des audits.<br /><br /><strong>Exemples de documentations nécessaires :</strong> calendrier de revue des politiques, journaux de modifications ou versions, rapports d’incident/audit avec plans d’action, communications annonçant les mises à jour.",
          detailEn:
            "<strong>Detailed description:</strong> Confirm there is a documented review cadence ensuring policies stay current with organizational, regulatory, and threat landscape changes. Additional guidance: examine the review schedule, change logs, and how lessons learned are incorporated.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Review policies on a defined schedule.<br /><strong>Ex2:</strong> Update policies following major organizational or threat landscape changes.<br /><strong>Ex3:</strong> Incorporate lessons learned from incidents and audits.<br /><br /><strong>Supporting documentation examples:</strong> policy review calendars, version/change logs, incident or audit reports with action plans, and communications announcing updated policies.",
        },
        {
          id: "GV.OV-01",
          fn: "GOVERN",
          category: "GV.OV",
          fr: "Les résultats de la stratégie de risque cybersécurité sont-ils revus ?",
          en: "Are cybersecurity risk strategy results reviewed?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle vérifie que les résultats de la stratégie de gestion du risque cyber sont évalués régulièrement afin de confirmer leur contribution aux objectifs de mission. Informations complémentaires : vérifier les indicateurs de succès, les points de friction signalés et les ajustements recommandés.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Évaluer si la stratégie soutient la mission et les objectifs.<br /><strong>Ex2 :</strong> Identifier les risques issus d’un désalignement.<br /><strong>Ex3 :</strong> Évaluer si les processus sont trop restrictifs ou insuffisants.<br /><br /><strong>Exemples de documentations nécessaires :</strong> rapports de revue stratégique, comptes rendus de comités de pilotage, analyses d’alignement mission-stratégie, plans d’amélioration suite aux constats.",
          detailEn:
            "<strong>Detailed description:</strong> Ensure cybersecurity risk strategy outcomes are reviewed to confirm they support the mission and business objectives. Additional guidance: look for defined success measures, documented friction points, and resulting recommendations.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Assess whether strategy supports mission/objectives.<br /><strong>Ex2:</strong> Identify risks arising from misalignment.<br /><strong>Ex3:</strong> Evaluate whether processes are overly restrictive or insufficient.<br /><br /><strong>Supporting documentation examples:</strong> strategy review reports, steering committee minutes, mission-to-strategy alignment analyses, and improvement plans tied to review findings.",
        },
        {
          id: "GV.OV-02",
          fn: "GOVERN",
          category: "GV.OV",
          fr: "La stratégie est-elle ajustée en fonction de l’environnement opérationnel ?",
          en: "Is the strategy adjusted based on the operating environment?",
          detailFr:
            "<strong>Description détaillée :</strong> La question confirme que la stratégie cybersécurité évolue en fonction des audits, performances, incidents et retours des parties prenantes afin de rester adaptée au contexte. Informations complémentaires : examiner la boucle d’amélioration continue reliant les signaux internes/externes aux décisions stratégiques.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Modifier la stratégie à la suite d’audits, d’écarts de performance ou de tendances d’incidents.<br /><strong>Ex2 :</strong> Ajuster les politiques en fonction des nouvelles menaces.<br /><strong>Ex3 :</strong> Intégrer les retours des parties prenantes.<br /><br /><strong>Exemples de documentations nécessaires :</strong> plans d’action issus d’audits ou d’incidents, décisions de mise à jour stratégique, communications sur l’évolution des politiques, registres des retours utilisateurs/parties prenantes.",
          detailEn:
            "<strong>Detailed description:</strong> Verify the cybersecurity strategy is adapted when audits, performance gaps, incidents, or stakeholder feedback reveal new needs. Additional guidance: trace how internal/external signals feed continuous improvement decisions.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Modify the strategy in response to audits, performance gaps, or incident trends.<br /><strong>Ex2:</strong> Adjust policies based on new threats.<br /><strong>Ex3:</strong> Incorporate feedback from stakeholders.<br /><br /><strong>Supporting documentation examples:</strong> audit or incident action plans, strategic update decisions, communications on policy changes, and logs capturing stakeholder feedback and resulting adjustments.",
        },
        {
          id: "GV.OV-03",
          fn: "GOVERN",
          category: "GV.OV",
          fr: "La performance de la gestion du risque cybersécurité est-elle évaluée ?",
          en: "Is cybersecurity risk management performance evaluated?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle s’assure que des indicateurs (KPI/KRI) et tableaux de bord suivent l’efficacité de la gestion du risque cyber, avec des actions déclenchées en cas d’écart. Informations complémentaires : vérifier le périmètre des métriques, leur fréquence de revue et l’intégration dans les plans d’action.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Suivre les KPI/KRI et les présenter aux dirigeants.<br /><strong>Ex2 :</strong> Utiliser des tableaux de bord et des métriques orientées résultats.<br /><strong>Ex3 :</strong> Ajuster les plans d’action en fonction des métriques et tendances.<br /><br /><strong>Exemples de documentations nécessaires :</strong> tableaux de bord de performance, rapports périodiques aux dirigeants, registres KPI/KRI, comptes rendus de comités décidant des plans d’action.",
          detailEn:
            "<strong>Detailed description:</strong> Confirm cybersecurity risk management performance is tracked with KPIs/KRIs and dashboards, and that metrics drive action plans. Additional guidance: review metric scope, reporting frequency, and how trends feed remediation decisions.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Track KPIs/KRIs and report them to leadership.<br /><strong>Ex2:</strong> Use dashboards and outcome-based metrics.<br /><strong>Ex3:</strong> Adjust action plans based on metrics and trends.<br /><br /><strong>Supporting documentation examples:</strong> performance dashboards, leadership reporting packs, KPI/KRI registers, and meeting minutes documenting metric-driven decisions.",
        },
        {
          id: "GV.SC-01",
          fn: "GOVERN",
          category: "GV.SC",
          fr: "Un programme de gestion des risques de la chaîne d’approvisionnement (C-SCRM) est-il établi ?",
          en: "Is a supply chain risk management (C-SCRM) program established?",
          detailFr:
            "<strong>Description détaillée :</strong> La question vérifie l’existence d’un programme formalisé couvrant les objectifs, la portée, les processus et la gouvernance du C-SCRM. Informations complémentaires : confirmer l’implication des parties prenantes clés et la définition des dépendances critiques.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Définir les objectifs et la portée du C-SCRM.<br /><strong>Ex2 :</strong> Développer des politiques et processus dédiés.<br /><strong>Ex3 :</strong> Impliquer les parties prenantes dans la planification.<br /><br /><strong>Exemples de documentations nécessaires :</strong> charte de programme C-SCRM, politiques ou standards SCRM, organigramme de gouvernance, analyses de dépendances critiques.",
          detailEn:
            "<strong>Detailed description:</strong> Ensure a formal C-SCRM program exists with defined objectives, scope, processes, and governance. Additional guidance: confirm key stakeholders participate and critical dependencies are captured.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Define C-SCRM objectives and scope.<br /><strong>Ex2:</strong> Develop policies and processes.<br /><strong>Ex3:</strong> Engage stakeholders in planning.<br /><br /><strong>Supporting documentation examples:</strong> C-SCRM program charters, policies or standards, governance charts, and critical dependency analyses.",
        },
        {
          id: "GV.SC-02",
          fn: "GOVERN",
          category: "GV.SC",
          fr: "Les rôles et responsabilités du C-SCRM sont-ils établis ?",
          en: "Are roles and responsibilities for C-SCRM established?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle confirme que les rôles en charge de la surveillance des fournisseurs et dépendances sont identifiés, documentés et communiqués. Informations complémentaires : vérifier les matrices RACI, les chartes de comité et la prise en compte des responsabilités dans les fonctions clés.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Identifier les rôles responsables de la supervision des fournisseurs.<br /><strong>Ex2 :</strong> Documenter les responsabilités dans les politiques ou RACI.<br /><strong>Ex3 :</strong> Intégrer le SCRM dans les fonctions et descriptions de poste.<br /><br /><strong>Exemples de documentations nécessaires :</strong> chartes de gouvernance SCRM, RACI détaillés, descriptions de postes incluant les responsabilités SCRM, procès-verbaux de comités fournisseurs.",
          detailEn:
            "<strong>Detailed description:</strong> Verify supplier oversight roles are assigned, documented, and communicated so responsibilities across procurement, risk, and security are clear. Additional guidance: review RACIs, committee charters, and job descriptions reflecting SCRM duties.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Identify responsible roles for supplier oversight.<br /><strong>Ex2:</strong> Document responsibilities in policies/RACI.<br /><strong>Ex3:</strong> Integrate SCRM into job functions.<br /><br /><strong>Supporting documentation examples:</strong> SCRM governance charters, detailed RACIs, role descriptions containing SCRM duties, and supplier oversight committee minutes.",
        },
        {
          id: "GV.SC-03",
          fn: "GOVERN",
          category: "GV.SC",
          fr: "Le C-SCRM est-il intégré à la gestion globale des risques ?",
          en: "Is C-SCRM integrated with broader risk management?",
          detailFr:
            "<strong>Description détaillée :</strong> La question vérifie que le programme SCRM s’aligne sur l’ERM et partage les circuits d’escalade, de reporting et d’amélioration continue. Informations complémentaires : vérifier la cohérence des registres de risques, la présence du SCRM dans les comités ERM et les liens avec les plans d’amélioration.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Aligner le C-SCRM sur l’ERM.<br /><strong>Ex2 :</strong> Intégrer le C-SCRM aux processus d’escalade et de reporting.<br /><strong>Ex3 :</strong> L’intégrer aux processus d’amélioration continue.<br /><br /><strong>Exemples de documentations nécessaires :</strong> politiques ERM incluant le SCRM, registres de risques consolidés, rapports d’escalade, plans d’amélioration ou de transformation intégrant le SCRM.",
          detailEn:
            "<strong>Detailed description:</strong> Confirm C-SCRM aligns with enterprise risk management, sharing escalation, reporting, and continuous improvement processes. Additional guidance: inspect enterprise risk registers, ERM committee materials, and improvement plans referencing SCRM.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Align SCRM with ERM.<br /><strong>Ex2:</strong> Incorporate C-SCRM into escalation and reporting.<br /><strong>Ex3:</strong> Integrate with continuous improvement processes.<br /><br /><strong>Supporting documentation examples:</strong> ERM policies referencing SCRM, consolidated risk registers, escalation reports, and improvement or transformation plans including SCRM.",
        },
        {
          id: "GV.SC-04",
          fn: "GOVERN",
          category: "GV.SC",
          fr: "Les fournisseurs et dépendances sont-ils identifiés ?",
          en: "Are suppliers and dependencies identified?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle confirme l’existence d’un inventaire complet des fournisseurs, services associés et dépendances critiques permettant d’évaluer les risques de la chaîne d’approvisionnement. Informations complémentaires : examiner les critères de criticité, les liens avec les actifs/services et les points de défaillance documentés.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Recenser les fournisseurs et services associés.<br /><strong>Ex2 :</strong> Classer les fournisseurs selon leur criticité.<br /><strong>Ex3 :</strong> Identifier les points de défaillance des dépendances.<br /><br /><strong>Exemples de documentations nécessaires :</strong> registre des fournisseurs, matrices services-fournisseurs, analyses de criticité, cartographies de dépendances, rapports d’évaluation SCRM.",
          detailEn:
            "<strong>Detailed description:</strong> Ensure a complete inventory captures suppliers, related services, and critical dependencies used to assess supply chain risk. Additional guidance: check criticality tiers, mappings to assets/services, and documented points of failure.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Inventory suppliers and related services.<br /><strong>Ex2:</strong> Classify suppliers by criticality.<br /><strong>Ex3:</strong> Identify dependency points of failure.<br /><br /><strong>Supporting documentation examples:</strong> supplier registers, service-to-supplier matrices, criticality analyses, dependency maps, and SCRM assessment reports.",
        },
        {
          id: "GV.SC-05",
          fn: "GOVERN",
          category: "GV.SC",
          fr: "Les exigences de sécurité pour les fournisseurs sont-elles définies ?",
          en: "Are requirements for suppliers established?",
          detailFr:
            "<strong>Description détaillée :</strong> Vérifie que les exigences de sécurité adaptées au niveau de criticité des fournisseurs sont définies et intégrées dans les contrats ou SLA. Informations complémentaires : examiner les référentiels d’exigences, les clauses contractuelles et les critères de reporting attendus.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Définir les exigences de sécurité en fonction de la criticité.<br /><strong>Ex2 :</strong> Intégrer les exigences dans les contrats/SLA.<br /><strong>Ex3 :</strong> Définir les attentes en matière de performance et de reporting sécurité.<br /><br /><strong>Exemples de documentations nécessaires :</strong> référentiels d’exigences fournisseurs, modèles de contrats ou SLA, check-lists d’évaluation, guides de reporting sécurité.",
          detailEn:
            "<strong>Detailed description:</strong> Confirm supplier security requirements are defined by criticality and embedded into contracts or SLAs, with clear reporting expectations. Additional guidance: review requirement catalogs, contractual clauses, and performance/ security reporting criteria.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Define security requirements based on criticality.<br /><strong>Ex2:</strong> Integrate requirements in contracts/SLAs.<br /><strong>Ex3:</strong> Define performance and security reporting expectations.<br /><br /><strong>Supporting documentation examples:</strong> supplier requirement catalogs, contract or SLA templates, assessment checklists, and security reporting guidance.",
        },
        {
          id: "GV.SC-06",
          fn: "GOVERN",
          category: "GV.SC",
          fr: "Une diligence raisonnable est-elle effectuée avant l’engagement des fournisseurs ?",
          en: "Is pre-engagement due diligence performed?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle confirme qu’une évaluation des risques est menée avant de contractualiser avec un fournisseur, incluant questionnaires, audits ou vérifications de certifications. Informations complémentaires : examiner les critères d’acceptation, les preuves documentées et l’implication des fonctions risque/juridique.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Évaluer le risque fournisseur avant la contractualisation.<br /><strong>Ex2 :</strong> Mener des questionnaires, audits ou revues de certifications.<br /><strong>Ex3 :</strong> Documenter les conditions d’approbation.<br /><br /><strong>Exemples de documentations nécessaires :</strong> procédures de due diligence, rapports d’évaluation, questionnaires complétés, grilles de décision, validations juridiques.",
          detailEn:
            "<strong>Detailed description:</strong> Ensure supplier risk is assessed before contracting through questionnaires, audits, or certification reviews, with documented approval criteria. Additional guidance: look at due diligence procedures, evidence packages, and legal/risk involvement.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Assess supplier risk before contracting.<br /><strong>Ex2:</strong> Conduct questionnaire, audit, or certification review.<br /><strong>Ex3:</strong> Document conditions for approval.<br /><br /><strong>Supporting documentation examples:</strong> due diligence procedures, assessment reports, completed questionnaires, decision matrices, and legal approvals.",
        },
        {
          id: "GV.SC-07",
          fn: "GOVERN",
          category: "GV.SC",
          fr: "Les risques liés aux fournisseurs sont-ils surveillés ?",
          en: "Are risks from suppliers monitored?",
          detailFr:
            "<strong>Description détaillée :</strong> La question vérifie que les risques fournisseurs sont suivis tout au long du cycle de vie, avec des réévaluations périodiques et un suivi des plans de remédiation. Informations complémentaires : analyser les indicateurs de risque tiers, les rapports de surveillance et les processus d’escalade.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Suivre les risques fournisseurs sur l’ensemble du cycle de vie.<br /><strong>Ex2 :</strong> Actualiser régulièrement les évaluations de risque.<br /><strong>Ex3 :</strong> Surveiller la remédiation des risques fournisseurs.<br /><br /><strong>Exemples de documentations nécessaires :</strong> registres de risques tiers, rapports de surveillance continue, revues périodiques, plans de remédiation et preuves de suivi.",
          detailEn:
            "<strong>Detailed description:</strong> Confirm supplier risks are monitored throughout the lifecycle via periodic reassessments and remediation tracking. Additional guidance: review third-party risk indicators, monitoring reports, and escalation procedures.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Track supplier risks over lifecycle.<br /><strong>Ex2:</strong> Update risk assessments regularly.<br /><strong>Ex3:</strong> Monitor remediation of supplier risks.<br /><br /><strong>Supporting documentation examples:</strong> third-party risk registers, continuous monitoring reports, periodic review records, remediation plans, and follow-up evidence.",
        },
        {
          id: "GV.SC-08",
          fn: "GOVERN",
          category: "GV.SC",
          fr: "Les fournisseurs participent-ils à la réponse aux incidents ?",
          en: "Do suppliers participate in incident response?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle confirme que les rôles des fournisseurs durant la réponse aux incidents sont définis, partagés et testés. Informations complémentaires : vérifier les clauses contractuelles, les procédures de communication et l’inclusion des fournisseurs dans les exercices.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Définir les rôles des fournisseurs pendant les incidents.<br /><strong>Ex2 :</strong> Partager les procédures et canaux de communication.<br /><strong>Ex3 :</strong> Inclure les fournisseurs dans les exercices de réponse aux incidents.<br /><br /><strong>Exemples de documentations nécessaires :</strong> plans de réponse aux incidents intégrant les fournisseurs, annexes contractuelles, playbooks de communication, comptes rendus d’exercices impliquant les partenaires.",
          detailEn:
            "<strong>Detailed description:</strong> Verify supplier roles during incidents are defined, communicated, and rehearsed through joint exercises. Additional guidance: inspect contractual clauses, communication procedures, and evidence of supplier participation in IR tests.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Define roles of suppliers during incidents.<br /><strong>Ex2:</strong> Share procedures and communication channels.<br /><strong>Ex3:</strong> Include suppliers in IR exercises.<br /><br /><strong>Supporting documentation examples:</strong> incident response plans including suppliers, contractual appendices, communication playbooks, and exercise reports featuring partner participation.",
        },
        {
          id: "GV.SC-09",
          fn: "GOVERN",
          category: "GV.SC",
          fr: "Les pratiques de C-SCRM sont-elles surveillées ?",
          en: "Are C-SCRM practices monitored?",
          detailFr:
            "<strong>Description détaillée :</strong> La question confirme que l’organisation suit l’efficacité de ses pratiques SCRM (processus, contrôles, respect des exigences) via des indicateurs, audits ou revues périodiques. Informations complémentaires : vérifier les rapports de performance fournisseurs, le suivi des SLA et les audits dédiés.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Revoir la performance et la conformité des fournisseurs.<br /><strong>Ex2 :</strong> Suivre les SLA et les métriques de sécurité.<br /><strong>Ex3 :</strong> Inclure le SCRM dans les audits.<br /><br /><strong>Exemples de documentations nécessaires :</strong> rapports de performance fournisseurs, tableaux de bord SLA, rapports d’audit SCRM, plans d’amélioration continue.",
          detailEn:
            "<strong>Detailed description:</strong> Ensure SCRM practices are monitored for effectiveness through performance reviews, SLA tracking, and dedicated audits. Additional guidance: analyze supplier scorecards, SLA dashboards, and audit reports focused on SCRM.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Review supplier performance and compliance.<br /><strong>Ex2:</strong> Track SLAs and security metrics.<br /><strong>Ex3:</strong> Include SCRM in audits.<br /><br /><strong>Supporting documentation examples:</strong> supplier performance reports, SLA dashboards, SCRM audit reports, and continuous improvement plans.",
        },
        {
          id: "GV.SC-10",
          fn: "GOVERN",
          category: "GV.SC",
          fr: "La sortie des fournisseurs est-elle gérée ?",
          en: "Is supplier offboarding managed?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle vérifie que la fin de contrat des fournisseurs est encadrée par des procédures couvrant la révocation des accès, la restitution/destruction des données et la vérification des obligations résiduelles. Informations complémentaires : examiner les check-lists d’offboarding, les journaux de révocation et les preuves de destruction de données.<br /><br /><strong>Exemples d’implémentation :</strong> <strong>Ex1 :</strong> Révoquer les accès et identifiants lors de l’offboarding.<br /><strong>Ex2 :</strong> Récupérer ou détruire de façon sécurisée les données.<br /><strong>Ex3 :</strong> Vérifier les obligations contractuelles après la résiliation.<br /><br /><strong>Exemples de documentations nécessaires :</strong> procédures d’offboarding fournisseurs, rapports de révocation d’accès, certificats de destruction/restitution des données, check-lists de clôture contractuelle.",
          detailEn:
            "<strong>Detailed description:</strong> Confirm supplier offboarding processes revoke access, recover or securely destroy data, and validate remaining contractual obligations. Additional guidance: review offboarding checklists, access revocation logs, and data destruction attestations.<br /><br /><strong>Implementation examples:</strong> <strong>Ex1:</strong> Revoke access and credentials during offboarding.<br /><strong>Ex2:</strong> Recover or securely destroy data.<br /><strong>Ex3:</strong> Validate contractual obligations after termination.<br /><br /><strong>Supporting documentation examples:</strong> supplier offboarding procedures, access revocation reports, data destruction/return certificates, and contract closure checklists.",
        },
        {
          id: "ID.AM-01",
          fn: "IDENTIFY",
          category: "ID.AM",
          fr: "Les inventaires du matériel géré par l’organisation sont-ils maintenus à jour ?",
          en: "Are inventories of hardware managed by the organization maintained?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle vérifie que tous les équipements physiques (serveurs, postes, IoT, OT, périphériques) sont recensés, suivis et reliés à leur localisation ou propriétaire. Informations complémentaires : rechercher une CMDB ou un outil d’ITAM intégrant les attributs critiques, des scans de découverte et des procédures pour intégrer/sortir les actifs matériels.<br /><br /><strong>Exemples d’implémentation :</strong> inventaire automatisé couplé aux agents EDR/MDM, rapprochement mensuel avec les données de stocks, revues avec les propriétaires d’actifs pour valider la complétude.<br /><br /><strong>Exemples de documentations nécessaires :</strong> CMDB ou registre matériel, rapports d’asset discovery, politiques d’onboarding/offboarding matériel, comptes rendus d’inventaires physiques, procédures d’escalade pour actifs inconnus.",
          detailEn:
            "<strong>Detailed description:</strong> Confirms every physical device (servers, endpoints, IoT/OT, peripherals) is recorded, tracked, and tied to a location or owner. Additional guidance: look for a CMDB or ITAM tool capturing critical attributes, automated discovery scans, and procedures covering hardware intake and retirement.<br /><br /><strong>Implementation examples:</strong> automated inventories fed by EDR/MDM agents, monthly reconciliations with warehouse data, and owner attestation campaigns validating completeness.<br /><br /><strong>Supporting documentation examples:</strong> hardware CMDB exports, asset discovery reports, hardware onboarding/offboarding policies, physical inventory minutes, and escalation procedures for unidentified devices.",
        },
        {
          id: "ID.AM-02",
          fn: "IDENTIFY",
          category: "ID.AM",
          fr: "Les inventaires des logiciels, services et systèmes gérés par l’organisation sont-ils maintenus ?",
          en: "Are inventories of software, services, and systems managed by the organization maintained?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question confirme que le périmètre applicatif (logiciels installés, services SaaS, systèmes OT/IT) est recensé avec les versions, propriétaires et statuts d’usage. Informations complémentaires : vérifier la présence d’un référentiel applicatif, d’un catalogue de services ou d’un outil de Software Asset Management (SAM) aligné sur les licences et usages.<br /><br /><strong>Exemples d’implémentation :</strong> catalogue applicatif relié aux pipelines DevSecOps, portail SaaS approuvé, inventaires automatiques issus des scanners ou des agents de gestion logicielle.<br /><br /><strong>Exemples de documentations nécessaires :</strong> registre applicatif/SAM, listes de services SaaS autorisés, politiques de gestion des logiciels, rapports d’audits de licences, tickets de revue périodique des services.",
          detailEn:
            "<strong>Detailed description:</strong> Validates that the application estate (installed software, SaaS subscriptions, OT/IT systems) is cataloged with versions, owners, and usage status. Additional guidance: look for an application register, a service catalog, or a software asset management (SAM) platform reconciled with license and consumption records.<br /><br /><strong>Implementation examples:</strong> application catalogs tied to DevSecOps pipelines, approved SaaS portals, and automated inventories from discovery scanners or software management agents.<br /><br /><strong>Supporting documentation examples:</strong> SAM exports, authorized SaaS lists, software management policies, license audit reports, and periodic service review tickets.",
        },
        {
          id: "ID.AM-03",
          fn: "IDENTIFY",
          category: "ID.AM",
          fr: "Des représentations des communications réseau autorisées et des flux de données internes/externes sont-elles maintenues ?",
          en: "Are representations of authorized network communication and internal and external data flows maintained?",
          detailFr:
            "<strong>Description détaillée :</strong> Le contrôle évalue la disponibilité de schémas réseau, cartographies de flux et modèles de segmentation permettant d’identifier les échanges autorisés. Informations complémentaires : examiner la mise à jour des diagrammes, la traçabilité des dépendances inter-applicatives et l’usage de sondes ou d’outils de cartographie dynamique.<br /><br /><strong>Exemples d’implémentation :</strong> diagrammes Visio ou IaC générés automatiquement, cartographie des flux via des outils de Network Detection & Response, revues trimestrielles des règles de pare-feu pour confirmer les flux autorisés.<br /><br /><strong>Exemples de documentations nécessaires :</strong> diagrammes réseau, matrices de flux applicatifs, rapports de revue des règles réseau, exportations d’outils de cartographie dynamique, procédures de gestion des changements réseau.",
          detailEn:
            "<strong>Detailed description:</strong> Assesses whether network diagrams, data-flow maps, and segmentation models exist and stay updated so authorized communications are understood. Additional guidance: review diagram maintenance practices, traceability of inter-application dependencies, and use of sensors or dynamic mapping tooling.<br /><br /><strong>Implementation examples:</strong> automatically generated Visio/IaC diagrams, flow maps from network detection platforms, and quarterly firewall-rule reviews validating authorized exchanges.<br /><br /><strong>Supporting documentation examples:</strong> network diagrams, application flow matrices, firewall review reports, exports from dynamic mapping tools, and network change procedures.",
        },
        {
          id: "ID.AM-04",
          fn: "IDENTIFY",
          category: "ID.AM",
          fr: "Les inventaires des services fournis par les fournisseurs sont-ils tenus à jour ?",
          en: "Are inventories of services provided by suppliers maintained?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle s’assure que les services externalisés (cloud, MSSP, BPO, SaaS critiques) sont inventoriés avec leurs dépendances, contrats et exigences de sécurité. Informations complémentaires : vérifier la présence d’un registre des fournisseurs, d’évaluations de risques tiers et de liens vers les responsables internes.<br /><br /><strong>Exemples d’implémentation :</strong> base tiers intégrant les niveaux de criticité, fiche service/fournisseur partagée avec la gestion des contrats, rapprochement avec les clauses de sécurité.<br /><br /><strong>Exemples de documentations nécessaires :</strong> registre de fournisseurs critiques, fiches de services externalisés, SLA/contrats avec clauses cyber, rapports d’évaluation des tiers, preuves de revues périodiques.",
          detailEn:
            "<strong>Detailed description:</strong> Ensures outsourced services (cloud, MSSP, BPO, critical SaaS) are cataloged with dependencies, contracts, and security requirements. Additional guidance: confirm the existence of a supplier register, third-party risk assessments, and mappings to internal owners.<br /><br /><strong>Implementation examples:</strong> vendor databases capturing criticality tiers, service/supplier fact sheets linked to contract management, and reconciliations with security clauses.<br /><br /><strong>Supporting documentation examples:</strong> critical supplier registers, outsourced service profiles, SLAs/contracts with cybersecurity provisions, third-party assessment reports, and evidence of periodic reviews.",
        },
        {
          id: "ID.AM-05",
          fn: "IDENTIFY",
          category: "ID.AM",
          fr: "Les actifs sont-ils priorisés selon leur classification, criticité, ressources et impact sur la mission ?",
          en: "Are assets prioritized based on classification, criticality, resources, and impact on the mission?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question vérifie l’existence d’une grille de criticité permettant de hiérarchiser les actifs et d’orienter les investissements de sécurité. Informations complémentaires : rechercher une politique de classification, des critères d’impact métier et des liens avec les plans de continuité ou de gestion des risques.<br /><br /><strong>Exemples d’implémentation :</strong> matrice de priorisation alignée sur les objectifs métiers, attribution d’un niveau de protection attendu par actif, arbitrages budgétaires basés sur ces niveaux.<br /><br /><strong>Exemples de documentations nécessaires :</strong> politique de classification/criticité, registre des actifs avec niveaux assignés, rapports de comités de priorisation, plans de traitement ou de continuité liés aux actifs critiques.",
          detailEn:
            "<strong>Detailed description:</strong> Confirms a criticality scheme ranks assets to direct security investments. Additional guidance: check for classification policies, business impact criteria, and links to continuity or risk management plans.<br /><br /><strong>Implementation examples:</strong> prioritization matrices aligned with business objectives, expected protection levels per asset, and budget decisions referencing those tiers.<br /><br /><strong>Supporting documentation examples:</strong> classification/criticality policies, asset registers with assigned tiers, prioritization committee reports, and treatment or continuity plans tied to critical assets.",
        },
        {
          id: "ID.AM-06",
          fn: "IDENTIFY",
          category: "ID.AM",
          fr: "Les inventaires des données et métadonnées associées pour les types de données désignés sont-ils maintenus ?",
          en: "Are inventories of data and corresponding metadata for designated data types maintained?",
          detailFr:
            "<strong>Description détaillée :</strong> Le contrôle exige une visibilité sur les jeux de données sensibles (PII, IP, données industrielles) avec localisation, propriétaires, exigences réglementaires et métadonnées (format, volume, cycle de vie). Informations complémentaires : vérifier l’existence d’un registre de données, d’un catalogue ou d’un outil de data governance reliant les exigences de protection.<br /><br /><strong>Exemples d’implémentation :</strong> catalogue de données relié à un outil de gouvernance, fiches de données critiques mentionnant propriétaire, classification et obligations, découverte automatique des données sensibles dans les environnements cloud.<br /><br /><strong>Exemples de documentations nécessaires :</strong> data catalog, registre de PII, fiches de data stewardship, rapports de data discovery, politiques de conservation des données.",
          detailEn:
            "<strong>Detailed description:</strong> Requires visibility over sensitive datasets (PII, IP, industrial data) capturing location, owners, regulatory needs, and metadata (format, volume, lifecycle). Additional guidance: look for a data register, catalog, or governance platform linking required protections.<br /><br /><strong>Implementation examples:</strong> governance-backed data catalogs, critical data fact sheets referencing owners, classification and obligations, and automated sensitive-data discovery in cloud environments.<br /><br /><strong>Supporting documentation examples:</strong> data catalog exports, PII registers, data stewardship records, sensitive-data discovery reports, and data retention policies.",
        },
        {
          id: "ID.AM-07",
          fn: "IDENTIFY",
          category: "ID.AM",
          fr: "Les dépendances entre actifs, données et processus critiques sont-elles documentées et suivies ?",
          en: "Are dependencies between assets, data, and critical business processes documented and tracked?",
          detailFr:
            "<strong>Description détaillée :</strong> Cette question confirme que les liens entre actifs techniques, jeux de données et processus métiers sont connus afin d’anticiper les impacts et orchestrer les réponses. Informations complémentaires : vérifier les matrices de dépendances, les analyses d’impact métier et les correspondances entre inventaires d’actifs et chaînes de valeur.<br /><br /><strong>Exemples d’implémentation :</strong> cartographie reliant services métier, applications, infrastructures et données, outils d’architecture d’entreprise tenant à jour ces dépendances, exercices de simulation évaluant les impacts en cascade.<br /><br /><strong>Exemples de documentations nécessaires :</strong> matrices processus/actifs, analyses BIA, dossiers d’architecture, registres de dépendances dans la CMDB, comptes rendus d’exercices de continuité.",
          detailEn:
            "<strong>Detailed description:</strong> Confirms relationships between technical assets, datasets, and business processes are known to anticipate cascading impacts and orchestrate responses. Additional guidance: review dependency matrices, business impact analyses, and mappings between asset inventories and value chains.<br /><br /><strong>Implementation examples:</strong> maps linking business services to applications, infrastructure, and data; enterprise-architecture tools maintaining dependencies; and tabletop exercises validating cascading-impact scenarios.<br /><br /><strong>Supporting documentation examples:</strong> process-to-asset matrices, BIA reports, architecture dossiers, dependency records in the CMDB, and continuity exercise minutes.",
        },
        {
          id: "ID.AM-08",
          fn: "IDENTIFY",
          category: "ID.AM",
          fr: "Les systèmes, matériels, logiciels, services et données sont-ils gérés tout au long de leur cycle de vie ?",
          en: "Are systems, hardware, software, services, and data managed throughout their life cycles?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle vérifie que l’ensemble du cycle de vie (planification, acquisition, exploitation, maintenance, retrait) inclut des exigences de sécurité et de gouvernance des actifs. Informations complémentaires : examiner les processus d’ingénierie, d’intégration, de patching, de désaffectation sécurisée et les critères de transfert vers l’archivage.<br /><br /><strong>Exemples d’implémentation :</strong> check-lists de sécurité dans les processus de procurement, pipelines DevSecOps imposant des contrôles avant mise en production, procédures de nettoyage sécurisé et de destruction des données lors de la mise hors service.<br /><br /><strong>Exemples de documentations nécessaires :</strong> politiques de cycle de vie des actifs, procédures de déploiement/décommissionnement, preuves de patching et de maintenance, rapports de destruction de données, matrices de contrôle DevSecOps.",
          detailEn:
            "<strong>Detailed description:</strong> Ensures every lifecycle phase (planning, acquisition, operations, maintenance, retirement) embeds security and governance requirements for assets. Additional guidance: review engineering processes, onboarding, patching, secure decommissioning, and archival criteria.<br /><br /><strong>Implementation examples:</strong> security checklists within procurement workflows, DevSecOps pipelines enforcing gates pre-production, and sanitized disposal procedures when services are retired.<br /><br /><strong>Supporting documentation examples:</strong> asset lifecycle policies, deployment/decommissioning procedures, patching and maintenance evidence, data destruction reports, and DevSecOps control matrices.",
        },
        {
          id: "ID.IM-01",
          fn: "IDENTIFY",
          category: "ID.IM",
          fr: "Les améliorations sont-elles identifiées à partir des évaluations ?",
          en: "Are improvements identified from evaluations?",
          detailFr:
            "<strong>Description détaillée :</strong> Vérifie que les conclusions des évaluations (internes ou externes) alimentent un plan d’amélioration documenté et priorisé. Informations complémentaires : rechercher un processus formel pour collecter les constats, qualifier les causes racines et suivre les actions issues des évaluations.<br /><br /><strong>Exemples d’implémentation :</strong> intégration systématique des constats d’audit ou d’autoévaluation dans un backlog de remédiation, revue périodique des progrès par les responsables, traçabilité entre constat, cause et action.<br /><br /><strong>Exemples de documentations nécessaires :</strong> rapports d’audit/évaluation, matrices de causes racines, plans d’actions ou backlogs avec priorisation et échéances, comptes rendus de suivi.",
          detailEn:
            "<strong>Detailed description:</strong> Confirms findings from internal or external assessments feed a documented, prioritized improvement plan. Additional guidance: look for a formal process to capture findings, analyze root causes, and track actions derived from assessments.<br /><br /><strong>Implementation examples:</strong> systematically adding audit or self-assessment findings to a remediation backlog, periodic progress reviews by accountable owners, and traceability linking finding, root cause, and action.<br /><br /><strong>Supporting documentation examples:</strong> audit/assessment reports, root-cause matrices, action plans or backlogs with prioritization and due dates, and follow-up meeting minutes.",
        },
        {
          id: "ID.IM-02",
          fn: "IDENTIFY",
          category: "ID.IM",
          fr:
            "Les améliorations sont-elles identifiées à partir des tests et exercices de sécurité, y compris ceux menés en coordination avec les fournisseurs et tiers concernés ?",
          en:
            "Are improvements identified from security tests and exercises, including those done in coordination with suppliers and relevant third parties?",
          detailFr:
            "<strong>Description détaillée :</strong> S’assure que les tests techniques (pentests, scans) et les exercices (table-top, simulations de crise) produisent des plans d’amélioration, y compris pour les dépendances critiques fournisseurs/partenaires. Informations complémentaires : vérifier la présence de REX post-exercice, la classification des lacunes et l’attribution des actions aux parties prenantes internes et externes.<br /><br /><strong>Exemples d’implémentation :</strong> inclusion des retours d’exercices avec fournisseurs dans les plans de remédiation, mise à jour des playbooks SOC/CSIRT après un test, définition de SLA de correction partagés avec les tiers concernés.<br /><br /><strong>Exemples de documentations nécessaires :</strong> rapports de tests et d’exercices (internes et avec fournisseurs), comptes rendus de REX, listes des écarts identifiés, plans d’action avec propriétaires internes/externes, mises à jour de playbooks ou de procédures.",
          detailEn:
            "<strong>Detailed description:</strong> Ensures technical tests (pentests, scans) and exercises (tabletops, crisis simulations) generate improvement plans, including for critical supplier/partner dependencies. Additional guidance: check for post-exercise lessons-learned, gap classification, and action ownership across internal and external stakeholders.<br /><br /><strong>Implementation examples:</strong> incorporating exercise feedback with suppliers into remediation plans, updating SOC/CSIRT playbooks after testing, and defining shared remediation SLAs with involved third parties.<br /><br /><strong>Supporting documentation examples:</strong> test and exercise reports (internal and supplier-related), lessons-learned minutes, gap lists, action plans with internal/external owners, and updated playbooks or procedures.",
        },
        {
          id: "ID.IM-03",
          fn: "IDENTIFY",
          category: "ID.IM",
          fr:
            "Les améliorations sont-elles identifiées à partir de l’exécution des processus, procédures et activités opérationnelles ?",
          en:
            "Are improvements identified from execution of operational processes, procedures, and activities?",
          detailFr:
            "<strong>Description détaillée :</strong> Confirme que l’exploitation quotidienne (opérations, support, surveillance) produit des retours structurés pour améliorer les processus et contrôles. Informations complémentaires : rechercher un mécanisme de collecte des incidents mineurs, dysfonctionnements ou écarts opérationnels et leur transformation en actions d’amélioration continue.<br /><br /><strong>Exemples d’implémentation :</strong> revue régulière des tickets récurrents pour simplifier les procédures, indicateurs de performance/qualité utilisés pour prioriser des optimisations, boucle d’amélioration alimentée par les rapports d’incidents non majeurs.<br /><br /><strong>Exemples de documentations nécessaires :</strong> rapports d’exploitation ou de disponibilité, tableaux de bord d’incidents/problèmes, revues de performance des processus, registres d’amélioration continue et décisions associées.",
          detailEn:
            "<strong>Detailed description:</strong> Ensures day-to-day operations (run, support, monitoring) generate structured feedback to improve processes and controls. Additional guidance: look for mechanisms that collect minor incidents, operational deviations, or recurring issues and convert them into continuous-improvement actions.<br /><br /><strong>Implementation examples:</strong> regular review of recurring tickets to streamline procedures, using performance/quality indicators to prioritize optimizations, and feeding continuous-improvement loops with reports from non-major incidents.<br /><br /><strong>Supporting documentation examples:</strong> operations or availability reports, incident/problem dashboards, process performance reviews, continuous-improvement logs, and related decisions.",
        },
        {
          id: "ID.IM-04",
          fn: "IDENTIFY",
          category: "ID.IM",
          fr:
            "Des plans de réponse aux incidents et d’autres plans cybers qui affectent les opérations sont-ils établis, communiqués, maintenus et améliorés ?",
          en:
            "Are incident response and other cyber plans that affect operations established, communicated, maintained, and improved?",
          detailFr:
            "<strong>Description détaillée :</strong> Vérifie l’existence, la diffusion et la mise à jour continue des plans cyber impactant les opérations (réponse aux incidents, gestion de crise, continuité). Informations complémentaires : s’assurer que les plans sont testés, qu’ils intègrent les retours d’expérience et qu’ils sont accessibles aux parties prenantes pertinentes.<br /><br /><strong>Exemples d’implémentation :</strong> calendrier de tests et d’exercices des plans, communication des rôles et contacts critiques, revue annuelle intégrant les leçons apprises et les changements organisationnels ou technologiques.<br /><br /><strong>Exemples de documentations nécessaires :</strong> plans de réponse aux incidents et de crise, registres de diffusion ou d’accessibilité, rapports d’exercices et de tests, historiques de mises à jour et décisions d’amélioration.",
          detailEn:
            "<strong>Detailed description:</strong> Confirms cyber plans affecting operations (incident response, crisis management, continuity) are established, communicated, continuously maintained, and improved. Additional guidance: verify plans are tested, incorporate lessons learned, and remain accessible to relevant stakeholders.<br /><br /><strong>Implementation examples:</strong> scheduled testing and exercise calendar for plans, communication of roles and critical contacts, and annual reviews incorporating lessons learned plus organizational/technology changes.<br /><br /><strong>Supporting documentation examples:</strong> incident response and crisis plans, distribution or accessibility records, exercise and test reports, update history, and improvement decisions.",
        },
        {
          id: "ID.RA-01",
          fn: "IDENTIFY",
          category: "ID.RA",
          fr: "Les vulnérabilités des actifs sont-elles identifiées, validées et enregistrées ?",
          en: "Are vulnerabilities in assets identified, validated, and recorded?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle vérifie l’existence d’un processus documenté pour détecter, valider et consigner les vulnérabilités (techniques et métier) affectant les actifs critiques. Informations complémentaires : rechercher des scans réguliers, une qualification des faux positifs et un registre des vulnérabilités avec responsables et échéances.<br /><br /><strong>Exemples d’implémentation :</strong> scans automatisés corrélés avec une CMDB, validation par les équipes SOC/ingénierie avant ouverture de tickets, priorisation basée sur la sévérité et la criticité des actifs.<br /><br /><strong>Exemples de documentations nécessaires :</strong> rapports de scans, procédures de tri et de validation, registre des vulnérabilités, tickets de remédiation avec dates cibles et responsables.",
          detailEn:
            "<strong>Detailed description:</strong> Validates that a documented process exists to detect, validate, and log vulnerabilities (technical and business) on critical assets. Additional guidance: check for regular scans, false-positive qualification, and a vulnerability register with owners and due dates.<br /><br /><strong>Implementation examples:</strong> automated scans correlated with the CMDB, SOC/engineering validation before ticket creation, and prioritization based on severity and asset criticality.<br /><br /><strong>Supporting documentation examples:</strong> scan reports, triage and validation procedures, vulnerability registers, and remediation tickets with target dates and owners.",
        },
        {
          id: "ID.RA-02",
          fn: "IDENTIFY",
          category: "ID.RA",
          fr: "Le renseignement sur les cybermenaces est-il enrichi par des forums et sources de partage d’information ?",
          en: "Is cyber threat intelligence informed from information sharing forums and sources?",
          detailFr:
            "<strong>Description détaillée :</strong> Confirme que l’organisation consomme et intègre des flux CTI (ISAC, CERT, sectoriels) pour alimenter les analyses de risques et la détection. Informations complémentaires : vérifier l’abonnement à des sources pertinentes, les règles de diffusion interne et l’intégration dans les playbooks SOC.<br /><br /><strong>Exemples d’implémentation :</strong> abonnements à des flux STIX/TAXII, participation à un ISAC sectoriel, synthèses CTI partagées aux équipes SOC/risque, enrichissement des règles de détection avec des IoC issus des flux.<br /><br /><strong>Exemples de documentations nécessaires :</strong> contrats ou adhésions CTI, procédures de gestion des renseignements, rapports de diffusion interne, tickets ou règles de détection enrichies par des IoC.",
          detailEn:
            "<strong>Detailed description:</strong> Ensures the organization consumes and integrates CTI feeds (ISAC, CERT, sector sources) to inform risk analysis and detection. Additional guidance: confirm subscriptions to relevant sources, internal dissemination rules, and SOC playbook integration.<br /><br /><strong>Implementation examples:</strong> STIX/TAXII feed subscriptions, participation in a sector ISAC, CTI briefs shared with SOC/risk teams, and detection rules enriched with feed IoCs.<br /><br /><strong>Supporting documentation examples:</strong> CTI contracts or memberships, intelligence handling procedures, internal CTI reports, and tickets or rules showing IoC-based enrichment.",
        },
        {
          id: "ID.RA-03",
          fn: "IDENTIFY",
          category: "ID.RA",
          fr: "Les menaces internes et externes pour l’organisation sont-elles identifiées et enregistrées ?",
          en: "Are internal and external threats to the organization identified and recorded?",
          detailFr:
            "<strong>Description détaillée :</strong> Vérifie la tenue d’un registre des menaces couvrant les acteurs internes, externes et tiers, avec des scénarios et motivations associés. Informations complémentaires : examiner les modèles de menace, les analyses d’environnement et les mises à jour périodiques.<br /><br /><strong>Exemples d’implémentation :</strong> cartographie des menaces internes (fraude, sabotage) et externes (APT, ransomware, hacktivisme), revue trimestrielle des scénarios par l’équipe risque, alignement des plans de contrôle sur ces scénarios.<br /><br /><strong>Exemples de documentations nécessaires :</strong> registre des menaces, modèles ou dossiers de menace, comptes rendus de revues périodiques, liens entre scénarios de menace et contrôles.",
          detailEn:
            "<strong>Detailed description:</strong> Confirms a threat register exists covering internal, external, and third-party actors with associated scenarios and motivations. Additional guidance: review threat models, environmental analyses, and periodic updates.<br /><br /><strong>Implementation examples:</strong> mapping internal threats (fraud, sabotage) and external ones (APT, ransomware, hacktivism), quarterly scenario reviews by risk teams, and control plans aligned to these scenarios.<br /><br /><strong>Supporting documentation examples:</strong> threat registers, threat models or dossiers, minutes from periodic reviews, and mappings from threat scenarios to controls.",
        },
        {
          id: "ID.RA-04",
          fn: "IDENTIFY",
          category: "ID.RA",
          fr: "Les impacts potentiels et les probabilités que des menaces exploitent les vulnérabilités sont-ils identifiés et enregistrés ?",
          en: "Are potential impacts and likelihoods of threats exploiting vulnerabilities identified and recorded?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce point confirme l’évaluation structurée de l’impact et de la vraisemblance des scénarios d’exploitation des vulnérabilités. Informations complémentaires : vérifier les matrices de cotation, les hypothèses de vraisemblance et les liens avec les niveaux de criticité des actifs.<br /><br /><strong>Exemples d’implémentation :</strong> utilisation d’une grille d’impact/vraisemblance normalisée, ateliers de scoring multi-équipes, révision périodique des hypothèses pour refléter l’évolution de la menace.<br /><br /><strong>Exemples de documentations nécessaires :</strong> matrices de scoring, rapports de scoring par scénario, hypothèses et sources utilisées, décisions de recalibrage ou de révision des scores.",
          detailEn:
            "<strong>Detailed description:</strong> Confirms structured assessment of impact and likelihood for scenarios where threats exploit vulnerabilities. Additional guidance: check scoring matrices, likelihood assumptions, and links to asset criticality tiers.<br /><br /><strong>Implementation examples:</strong> standardized impact/likelihood grids, multi-team scoring workshops, and periodic review of assumptions to reflect evolving threats.<br /><br /><strong>Supporting documentation examples:</strong> scoring matrices, scenario scoring reports, documented assumptions and sources, and decisions to recalibrate or revise scores.",
        },
        {
          id: "ID.RA-05",
          fn: "IDENTIFY",
          category: "ID.RA",
          fr: "Les menaces, vulnérabilités, probabilités et impacts sont-ils utilisés pour comprendre le risque inhérent et prioriser la réponse ?",
          en: "Are threats, vulnerabilities, likelihoods, and impacts used to understand inherent risk and inform risk response prioritization?",
          detailFr:
            "<strong>Description détaillée :</strong> Vérifie que les éléments de risque (menaces, vulnérabilités, impacts, vraisemblance) sont combinés pour déterminer le risque inhérent et orienter les priorités de traitement. Informations complémentaires : rechercher des rapports consolidés, une hiérarchisation des scénarios et la traçabilité vers les plans d’actions.<br /><br /><strong>Exemples d’implémentation :</strong> tableaux de bord de risques avec notation inhérente, critères de priorisation reliés aux objectifs métier, arbitrages documentés pour sélectionner les scénarios à traiter en premier.<br /><br /><strong>Exemples de documentations nécessaires :</strong> registres de risques avec scores inhérents, méthodologie de priorisation, comptes rendus de comités de priorisation, plans de traitement liés aux scénarios critiques.",
          detailEn:
            "<strong>Detailed description:</strong> Ensures risk elements (threats, vulnerabilities, impacts, likelihood) are combined to compute inherent risk and drive treatment priorities. Additional guidance: look for consolidated reporting, scenario ranking, and traceability into action plans.<br /><br /><strong>Implementation examples:</strong> risk dashboards with inherent scoring, prioritization criteria tied to business objectives, and documented trade-offs selecting scenarios to address first.<br /><br /><strong>Supporting documentation examples:</strong> risk registers with inherent scores, prioritization methodology, prioritization committee minutes, and treatment plans linked to critical scenarios.",
        },
        {
          id: "ID.RA-06",
          fn: "IDENTIFY",
          category: "ID.RA",
          fr: "Les réponses aux risques sont-elles choisies, hiérarchisées, planifiées, suivies et communiquées ?",
          en: "Are risk responses chosen, prioritized, planned, tracked, and communicated?",
          detailFr:
            "<strong>Description détaillée :</strong> Confirme l’existence d’un cycle de traitement des risques allant du choix des options (accepter, atténuer, transférer, éviter) jusqu’au suivi des plans et à la communication aux parties prenantes. Informations complémentaires : vérifier les matrices de décision, les plans de traitement avec jalons et les rapports de suivi.<br /><br /><strong>Exemples d’implémentation :</strong> fiches de décision par scénario, roadmaps de remédiation priorisées, suivi mensuel des jalons et communication aux sponsors métier.<br /><br /><strong>Exemples de documentations nécessaires :</strong> registres de décisions de traitement, plans d’action détaillés, indicateurs d’avancement, comptes rendus de communication ou de comités de pilotage.",
          detailEn:
            "<strong>Detailed description:</strong> Confirms a full risk-treatment cycle from selecting options (accept, mitigate, transfer, avoid) to planning, tracking, and communicating progress to stakeholders. Additional guidance: review decision matrices, treatment plans with milestones, and follow-up reports.<br /><br /><strong>Implementation examples:</strong> decision sheets per scenario, prioritized remediation roadmaps, monthly milestone tracking, and communications to business sponsors.<br /><br /><strong>Supporting documentation examples:</strong> treatment decision logs, detailed action plans, progress indicators, and communication or steering committee minutes.",
        },
        {
          id: "ID.RA-07",
          fn: "IDENTIFY",
          category: "ID.RA",
          fr: "Les changements et dérogations sont-ils gérés, évalués pour leur impact sur le risque, enregistrés et suivis ?",
          en: "Are changes and exceptions managed, assessed for risk impact, recorded, and tracked?",
          detailFr:
            "<strong>Description détaillée :</strong> Vérifie que tout changement ou dérogation aux contrôles est évalué pour son impact sur le risque, documenté et suivi jusqu’à sa clôture. Informations complémentaires : rechercher des procédures d’exception, l’évaluation des risques associée et un registre des dérogations avec dates de revue.<br /><br /><strong>Exemples d’implémentation :</strong> processus formalisé de gestion des exceptions de sécurité, revues de risque obligatoires avant approbation, suivi des dérogations et dates de fin prévues.<br /><br /><strong>Exemples de documentations nécessaires :</strong> formulaires d’exception, analyses de risque correspondantes, registres des dérogations, décisions d’approbation et preuves de clôture ou de renouvellement.",
          detailEn:
            "<strong>Detailed description:</strong> Ensures any change or control exception is risk-assessed, documented, and tracked to closure. Additional guidance: look for exception procedures, associated risk evaluations, and an exception register with review dates.<br /><br /><strong>Implementation examples:</strong> formal security exception process, mandatory risk reviews before approval, and tracking of exceptions with planned end dates.<br /><br /><strong>Supporting documentation examples:</strong> exception request forms, corresponding risk analyses, exception registers, approval decisions, and closure or renewal evidence.",
        },
        {
          id: "ID.RA-08",
          fn: "IDENTIFY",
          category: "ID.RA",
          fr: "Des processus de réception, d’analyse et de réponse aux divulgations de vulnérabilités sont-ils mis en œuvre ?",
          en: "Are processes for receiving, analyzing, and responding to vulnerability disclosures implemented?",
          detailFr:
            "<strong>Description détaillée :</strong> Confirme la présence d’un dispositif de divulgation responsable (VDP) ou de bug bounty permettant de recevoir, qualifier et traiter les vulnérabilités signalées par des tiers. Informations complémentaires : vérifier les canaux de soumission, les engagements de réponse et les procédures de remédiation.<br /><br /><strong>Exemples d’implémentation :</strong> publication d’une politique VDP, boîte de réception dédiée ou plateforme tierce, SLA de réponse aux chercheurs, intégration des tickets dans la chaîne de remédiation.<br /><br /><strong>Exemples de documentations nécessaires :</strong> politique VDP, instructions de soumission, rapports de vulnérabilités reçues, métriques de temps de réponse et de correction, preuves de communication avec les chercheurs.",
          detailEn:
            "<strong>Detailed description:</strong> Confirms a responsible disclosure (VDP) or bug bounty mechanism exists to receive, triage, and remediate externally reported vulnerabilities. Additional guidance: check submission channels, response commitments, and remediation procedures.<br /><br /><strong>Implementation examples:</strong> published VDP policy, dedicated inbox or third-party platform, response SLAs for researchers, and ticket integration into remediation workflows.<br /><br /><strong>Supporting documentation examples:</strong> VDP policy, submission instructions, received vulnerability reports, response and fix time metrics, and evidence of researcher communications.",
        },
        {
          id: "ID.RA-09",
          fn: "IDENTIFY",
          category: "ID.RA",
          fr: "L’authenticité et l’intégrité du matériel et des logiciels critiques pour la mission sont-elles évaluées avant acquisition et utilisation ?",
          en: "Are the authenticity and integrity of mission-critical hardware and software assessed prior to acquisition and use?",
          detailFr:
            "<strong>Description détaillée :</strong> Vérifie que des contrôles d’authenticité et d’intégrité (provenance, signature, chaîne d’approvisionnement) sont appliqués avant l’achat ou le déploiement de composants critiques. Informations complémentaires : examiner les exigences fournisseurs, les tests d’intégrité et les critères d’acceptation.<br /><br /><strong>Exemples d’implémentation :</strong> vérification des signatures et checksums des logiciels, contrôles de provenance des équipements, exigences contractuelles sur l’intégrité de la supply chain, tests d’acceptation sécurisés avant mise en service.<br /><br /><strong>Exemples de documentations nécessaires :</strong> procédures d’acquisition sécurisée, rapports de vérification d’intégrité, clauses contractuelles supply chain, procès-verbaux de tests d’acceptation.",
          detailEn:
            "<strong>Detailed description:</strong> Ensures authenticity and integrity checks (provenance, signatures, supply-chain validation) are applied before purchasing or deploying mission-critical components. Additional guidance: review supplier requirements, integrity testing, and acceptance criteria.<br /><br /><strong>Implementation examples:</strong> signature and checksum verification of software, provenance checks for equipment, contractual supply-chain integrity clauses, and secure acceptance testing before production use.<br /><br /><strong>Supporting documentation examples:</strong> secure procurement procedures, integrity verification reports, supply-chain contractual clauses, and acceptance test records.",
        },
        {
          id: "ID.RA-12",
          fn: "IDENTIFY",
          category: "ID.RA",
          fr: "Les fournisseurs critiques sont-ils évalués avant acquisition ?",
          en: "Are critical suppliers assessed prior to acquisition?",
          detailFr:
            "<strong>Description détaillée :</strong> Confirme qu’une évaluation des fournisseurs critiques est réalisée avant leur intégration, couvrant la posture de sécurité, la continuité et la conformité. Informations complémentaires : vérifier les questionnaires, audits ou certifications demandés et leur prise en compte dans la décision d’achat.<br /><br /><strong>Exemples d’implémentation :</strong> processus de due diligence cyber préalable à la signature, scoring de risque tiers influençant la sélection, validation des plans de remédiation avant onboarding.<br /><br /><strong>Exemples de documentations nécessaires :</strong> procédures d’évaluation fournisseurs, résultats de questionnaires ou audits, rapports de scoring, décisions d’achat et plans de remédiation contractualisés.",
          detailEn:
            "<strong>Detailed description:</strong> Confirms critical suppliers are evaluated before onboarding, covering security posture, continuity, and compliance. Additional guidance: check requested questionnaires, audits, or certifications and how they influence purchase decisions.<br /><br /><strong>Implementation examples:</strong> pre-signature cyber due diligence, third-party risk scoring influencing selection, and validation of remediation plans before onboarding.<br /><br /><strong>Supporting documentation examples:</strong> supplier assessment procedures, questionnaire or audit results, scoring reports, purchase decisions, and contractual remediation plans.",
        },
        {
          id: "PR-01",
          fn: "PROTECT",
          category: "PR.AC",
          fr: "Les accès sont-ils gérés selon le principe du moindre privilège ?",
          en: "Are accesses managed according to the least privilege principle?",
          detailFr:
            "<strong>Description détaillée :</strong> Vérifiez que les droits d’accès sont accordés en fonction des rôles, revus régulièrement et révoqués dès qu’ils ne sont plus nécessaires. Informations complémentaires : examiner les politiques IAM, les revues d’accès périodiques et les procédures de provisioning/deprovisioning.<br /><br /><strong>Exemples d’implémentation :</strong> modèles de rôles avec moindre privilège, campagnes de recertification d’accès, automatisation des retraits d’accès lors des départs.<br /><br /><strong>Exemples de documentations nécessaires :</strong> politique de gestion des accès, matrices de rôles et privilèges, rapports de revues d’accès, procédures IAM, journaux de recertification ou de désactivation.",
          detailEn:
            "<strong>Detailed description:</strong> Ensure access rights are role-based, reviewed regularly, and revoked promptly when no longer required to enforce least privilege. Additional guidance: review IAM policies, periodic access reviews, and provisioning/deprovisioning procedures.<br /><br /><strong>Implementation examples:</strong> role models enforcing least privilege, access recertification campaigns, and automated deprovisioning during offboarding.<br /><br /><strong>Supporting documentation examples:</strong> access management policy, role and privilege matrices, access review reports, IAM procedures, and recertification or deprovisioning logs.",
        },
        {
          id: "PR-02",
          fn: "PROTECT",
          category: "PR.IP",
          fr: "Des procédures formelles existent-elles pour la gestion des changements ?",
          en: "Are formal procedures in place for change management?",
          detailFr:
            "<strong>Description détaillée :</strong> La procédure de changement doit documenter les validations, tests, retours arrière et responsabilités afin de limiter les risques opérationnels. Informations complémentaires : rechercher un processus formalisé, des formulaires de demande et des preuves de revues par un CAB ou comité de changement.<br /><br /><strong>Exemples d’implémentation :</strong> procédure ITIL détaillant les étapes de validation, comité de changement hebdomadaire, vérification systématique des plans de retour arrière.<br /><br /><strong>Exemples de documentations nécessaires :</strong> politique ou procédure de gestion des changements, formulaires ou tickets de demande de changement, comptes rendus de CAB, calendrier des changements, rapports de tests et de plans de retour arrière.",
          detailEn:
            "<strong>Detailed description:</strong> Change processes should document approvals, testing, rollback plans, and ownership to limit operational and security risks. Additional guidance: identify the formal process, request templates, and evidence of CAB or change board reviews.<br /><br /><strong>Implementation examples:</strong> ITIL-based procedure detailing approval steps, weekly change advisory board meetings, and systematic validation of rollback plans.<br /><br /><strong>Supporting documentation examples:</strong> change management policy or procedure, change request forms or tickets, CAB minutes, change calendar, and testing or rollback evidence.",
        },
        {
          id: "DE-01",
          fn: "DETECT",
          category: "DE.CM",
          fr: "Un SOC ou une capacité de surveillance des journaux est-il en place ?",
          en: "Is a SOC or log monitoring capability in place?",
          detailFr:
            "<strong>Description détaillée :</strong> Le contrôle valide l’existence d’une surveillance continue (SOC interne/externe) capable de détecter rapidement des comportements anormaux. Informations complémentaires : vérifier la couverture des journaux, les capacités d’investigation et les engagements de service associés.<br /><br /><strong>Exemples d’implémentation :</strong> SOC interne 24/7 ou service MSSP, corrélation automatisée via SIEM, procédures d’escalade définies pour les alertes critiques.<br /><br /><strong>Exemples de documentations nécessaires :</strong> charte ou contrat SOC/MSSP, plan de surveillance des journaux, tableaux de bord SIEM, rapports de détection et d’escalade, procédures opérationnelles standard (SOP) du SOC.",
          detailEn:
            "<strong>Detailed description:</strong> This item confirms continuous monitoring is in place—internal or outsourced SOC—to rapidly detect anomalous behaviors. Additional guidance: validate log coverage, investigation capabilities, and related service commitments.<br /><br /><strong>Implementation examples:</strong> 24/7 internal SOC or MSSP service, automated SIEM correlation, and defined escalation procedures for critical alerts.<br /><br /><strong>Supporting documentation examples:</strong> SOC/MSSP charter or contract, log monitoring plan, SIEM dashboards, detection and escalation reports, and SOC standard operating procedures.",
        },
        {
          id: "RS-01",
          fn: "RESPOND",
          category: "RS.MI",
          fr: "Des plans de réponse aux incidents sont-ils définis et testés ?",
          en: "Are incident response plans defined and tested?",
          detailFr:
            "<strong>Description détaillée :</strong> Les plans doivent couvrir les scénarios majeurs, préciser les rôles et inclure des exercices réguliers pour vérifier l’efficacité de la réponse. Informations complémentaires : examiner la cartographie des scénarios, les procédures d’escalade et les retours d’expérience des exercices.<br /><br /><strong>Exemples d’implémentation :</strong> plan de réponse aux incidents détaillé par type d’incident, exercices annuels de simulation ou de table-top, revue post-incident intégrant les enseignements dans le plan.<br /><br /><strong>Exemples de documentations nécessaires :</strong> plan de réponse aux incidents, runbooks opérationnels, rapports d’exercices et de tests, fiches d’escalade et de communication, rapports post-incident.",
          detailEn:
            "<strong>Detailed description:</strong> Plans should cover major scenarios, clarify responsibilities, and include rehearsals or tabletop exercises to prove response effectiveness. Additional guidance: review scenario mapping, escalation procedures, and lessons learned from exercises.<br /><br /><strong>Implementation examples:</strong> incident response plan tailored to incident types, annual simulations or tabletop exercises, and post-incident reviews feeding updates into the plan.<br /><br /><strong>Supporting documentation examples:</strong> incident response plan, operational runbooks, exercise and test reports, escalation and communication playbooks, and post-incident reviews.",
        },
        {
          id: "RC-01",
          fn: "RECOVER",
          category: "RC.RP",
          fr: "Des plans de reprise des activités sont-ils documentés et testés ?",
          en: "Are business recovery plans documented and tested?",
          detailFr:
            "<strong>Description détaillée :</strong> Ce contrôle garantit la présence de procédures de reprise documentées, testées et alignées sur les objectifs de continuité de l’organisation. Informations complémentaires : analyser les plans de reprise, les rapports de tests PRA/PCA et les mécanismes de mise à jour.<br /><br /><strong>Exemples d’implémentation :</strong> plans de reprise par application ou service, exercices réguliers de bascule, revue des enseignements et mise à jour des procédures après chaque test.<br /><br /><strong>Exemples de documentations nécessaires :</strong> plans de reprise d’activité (PRA/PCA), procédures de restauration, rapports de tests de continuité, listes de contacts de crise, calendriers de tests et preuves de mises à jour.",
          detailEn:
            "<strong>Detailed description:</strong> Ensures recovery procedures are documented, tested, and aligned with organizational continuity objectives and recovery timeframes. Additional guidance: review recovery plans, PRA/BCP test reports, and update mechanisms.<br /><br /><strong>Implementation examples:</strong> service-specific recovery plans, regular failover exercises, and post-test reviews updating recovery procedures.<br /><br /><strong>Supporting documentation examples:</strong> business continuity/disaster recovery plans, restoration procedures, continuity test reports, crisis contact lists, test calendars, and evidence of plan updates.",
        },
      ];

      QUESTIONS.forEach((q) => {
        if (!Array.isArray(q.departments) || q.departments.length === 0) {
          q.departments = [...(CATEGORY_DEPARTMENT_MAP[q.category] || [])];
        }
      });

      const BASE_FUNCTION_CATEGORIES = {
        GOVERN: ["GV.OC", "GV.RM", "GV.RR", "GV.PO", "GV.OV", "GV.SC"],
        IDENTIFY: ["ID.AM", "ID.BE", "ID.IM", "ID.RA", "ID.RM", "ID.SC"],
        PROTECT: ["PR.AA", "PR.AT", "PR.DS", "PR.MA", "PR.PS", "PR.IR"],
        DETECT: ["DE.AE", "DE.CM", "DE.DP"],
        RESPOND: ["RS.RP", "RS.CO", "RS.AN", "RS.MI", "RS.IM", "RS.RR"],
        RECOVER: ["RC.RP", "RC.IM", "RC.CO"],
      };

      const FUNCTION_CATEGORIES = FUNCTIONS.reduce((acc, fn) => {
        const base = BASE_FUNCTION_CATEGORIES[fn.id] || [];
        const fromQuestions = QUESTIONS.filter((q) => q.fn === fn.id).map(
          (q) => q.category
        );
        const unique = Array.from(new Set([...base, ...fromQuestions]));
        acc[fn.id] = unique;
        return acc;
      }, {});

      const CATEGORY_TO_FUNCTION = Object.entries(FUNCTION_CATEGORIES).reduce(
        (map, [fnId, categories]) => {
          categories.forEach((category) => {
            map[category] = fnId;
          });
          return map;
        },
        {}
      );

      const ALL_CATEGORIES = FUNCTIONS.reduce((list, fn) => {
        (FUNCTION_CATEGORIES[fn.id] || []).forEach((category) => {
          if (!list.includes(category)) list.push(category);
        });
        return list;
      }, []);

      const DEFAULT_ANSWERS = QUESTIONS.reduce((acc, q) => {
        acc[q.id] = { target: 4 };
        return acc;
      }, {});

      const DEFAULT_META = {
        project: "",
        assessor: "",
        org: "",
        date: "",
      };

      function createDefaultAnswers() {
        const copy = {};
        QUESTIONS.forEach((q) => {
          copy[q.id] = { ...DEFAULT_ANSWERS[q.id] };
        });
        return copy;
      }

      function normalizeMeta(meta) {
        return { ...DEFAULT_META, ...(meta || {}) };
      }

      const FUNCTION_COLORS = {
        GOVERN: "#1E3A8A",
        IDENTIFY: "#2563EB",
        PROTECT: "#059669",
        DETECT: "#9333EA",
        RESPOND: "#DC2626",
        RECOVER: "#EA580C",
      };

      const I18N = {
        fr: {
          appTitle: "NIST CSF 2.0 – Questionnaire d’évaluation",
          meta: "Métadonnées",
          project: "Projet",
          assessor: "Évaluateur",
          org: "Organisation",
          date: "Date",
          globalLang: "Langue",
          dashboard: "Dashboard",
          maturityScore: "Score de maturité",
          maturityCurrent: "Maturité actuelle",
          maturityTargetLabel: "Cible",
          maturityTarget: "Score cible moyen",
          maturityByFn: "Maturité par Function",
          radarTitle: "Actuel vs Cible (par Function)",
          noDataYet:
            "Aucune donnée encore — commence à noter des questions pour alimenter le dashboard.",
          questions: "Questions",
          score: "Score",
          target: "Cible",
          comments: "Commentaires",
          searchPh: "Filtre (ID, texte, fonction...)",
          allFunctions: "Toutes les fonctions",
          filterByFunction: "Fonctions",
          filterByCategory: "Catégories",
          filterByDepartment: "Départements responsables",
          responsibleDepartmentsLabel: "Départements responsables",
          allCategories: "Toutes les catégories",
          allDepartments: "Tous les départements",
          functionColumn: "Fonction",
          categoryColumn: "Catégorie",
          tips1: "💾 Sauvegarde automatique (localStorage du navigateur).",
          tips2:
            "📤 Exportez vos données (CSV, PDF ou JSON) ou 📥 importez une évaluation au format JSON.",
          cmmiInfo:
            "Notation suggérée : 0–5 (inexistant à optimisé) selon CMMI / NIST.",
          targetInfo: "Objectif moyen saisi (0–5).",
          exportCsv: "Exporter en CSV",
          exportPdf: "Exporter en PDF",
          exportJson: "Exporter en JSON",
          importJson: "Importer une évaluation (JSON)",
          importJsonSuccess: "Évaluation importée avec succès.",
          importJsonError:
            "Impossible de lire le fichier JSON. Vérifiez le format du fichier.",
          resetForm: "Réinitialiser",
          confirmReset:
            "Voulez-vous vraiment réinitialiser le questionnaire ? Toutes les réponses et métadonnées seront effacées.",
          infoLabel: "Afficher les détails du contrôle",
        },
        en: {
          appTitle: "NIST CSF 2.0 – Assessment Questionnaire",
          meta: "Metadata",
          project: "Project",
          assessor: "Assessor",
          org: "Organization",
          date: "Date",
          globalLang: "Language",
          dashboard: "Dashboard",
          maturityScore: "Maturity score",
          maturityCurrent: "Current maturity",
          maturityTargetLabel: "Target maturity",
          maturityTarget: "Average target score",
          maturityByFn: "Maturity by Function",
          radarTitle: "Current vs Target (by Function)",
          noDataYet:
            "No data yet — start rating questions to feed the dashboard.",
          questions: "Questions",
          score: "Score",
          target: "Target",
          comments: "Comments",
          searchPh: "Filter (ID, text, function...)",
          allFunctions: "All functions",
          filterByFunction: "Functions",
          filterByCategory: "Categories",
          filterByDepartment: "Departments",
          responsibleDepartmentsLabel: "Responsible departments",
          allCategories: "All categories",
          allDepartments: "All departments",
          functionColumn: "Function",
          categoryColumn: "Category",
          tips1: "💾 Autosave enabled (browser localStorage).",
          tips2:
            "📤 Export your data (CSV, PDF, or JSON) or 📥 import an assessment from JSON.",
          cmmiInfo:
            "Suggested rating: 0–5 (non-existent to optimized) based on CMMI / NIST.",
          targetInfo: "Average target set (0–5).",
          exportCsv: "Export to CSV",
          exportPdf: "Export to PDF",
          exportJson: "Export to JSON",
          importJson: "Import assessment (JSON)",
          importJsonSuccess: "Assessment imported successfully.",
          importJsonError:
            "Unable to read the JSON file. Please verify its format.",
          resetForm: "Reset",
          confirmReset:
            "Do you really want to reset the questionnaire? All answers and metadata will be cleared.",
          infoLabel: "Show control details",
        },
      };

      // ------------------ Helpers ------------------

      function avg(values) {
        const nums = (values || []).filter(
          (v) => typeof v === "number" && !Number.isNaN(v)
        );
        if (!nums.length) return 0;
        return nums.reduce((a, b) => a + b, 0) / nums.length;
      }

      function TargetBarShape(props) {
        const { x, y, width, height, fill } = props;

        if (
          !Number.isFinite(x) ||
          !Number.isFinite(y) ||
          !Number.isFinite(width) ||
          !Number.isFinite(height) ||
          width <= 0 ||
          height <= 0
        ) {
          return null;
        }

        const strokeWidth = 2;
        const inset = strokeWidth / 2;
        const effectiveWidth = width - strokeWidth;
        const effectiveHeight = height - strokeWidth;

        if (effectiveWidth <= 0 || effectiveHeight <= 0) {
          return null;
        }

        const left = x + inset;
        const right = x + width - inset;
        const top = y + inset;
        const bottom = y + height - inset;
        const maxRadius = Math.min(
          6,
          effectiveWidth / 2,
          effectiveHeight
        );

        const path = [
          `M ${left} ${bottom}`,
          `L ${left} ${top + maxRadius}`,
          `Q ${left} ${top} ${left + maxRadius} ${top}`,
          `L ${right - maxRadius} ${top}`,
          `Q ${right} ${top} ${right} ${top + maxRadius}`,
          `L ${right} ${bottom}`,
          "Z",
        ].join(" ");

        return html`<path
          d=${path}
          fill="none"
          stroke=${fill}
          strokeWidth=${strokeWidth}
          strokeDasharray="4 4"
        />`;
      }

      // ------------------ Composants UI ------------------

      function Card({ title, children }) {
        return html`
          <section className="bg-white rounded-2xl shadow-sm border border-neutral-200 p-4 md:p-6 mb-4">
            ${title &&
            html`<h2
              className="text-lg font-semibold text-neutral-900 mb-3 flex items-center gap-2"
            >
              ${title}
            </h2>`}
            ${children}
          </section>
        `;
      }

      function TextInput({ label, value, onChange, type = "text" }) {
        return html`
          <label className="block text-sm mb-2">
            <span className="text-neutral-700">${label}</span>
            <input
              className="mt-1 w-full rounded-lg border border-neutral-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              type=${type}
              value=${value || ""}
              onChange=${(e) => onChange(e.target.value)}
            />
          </label>
        `;
      }

      function SelectScore({ value, onChange }) {
        const options = Array.from({ length: 6 }, (_, index) => index);
        return html`
          <select
            className="w-full rounded-md border border-neutral-300 px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            value=${value ?? ""}
            onChange=${(e) =>
              onChange(
                e.target.value === "" ? null : Number(e.target.value)
              )}
          >
            <option value="">–</option>
            ${options.map((v) =>
              html`<option key=${v} value=${v}>${v}</option>`
            )}
          </select>
        `;
      }

      // ------------------ App principale ------------------

      function NistCsfQuestionnaire() {
        const [lang, setLang] = useState("fr");
        const t = I18N[lang];

        const [meta, setMeta] = useState(() => normalizeMeta());

        const [answers, setAnswers] = useState(() => createDefaultAnswers());
        const [search, setSearch] = useState("");
        const [functionFilter, setFunctionFilter] = useState("ALL");
        const [selectedCategories, setSelectedCategories] = useState(
          () => [...ALL_CATEGORIES]
        );
        const [selectedDepartments, setSelectedDepartments] = useState(() => []);
        const [infoExpanded, setInfoExpanded] = useState({});
        const fileInputRef = useRef(null);

        // ---- Chargement / sauvegarde locale ----

        useEffect(() => {
          try {
            const saved = JSON.parse(
              localStorage.getItem("nist-csf-questionnaire-v1") || "{}"
            );
            setMeta(normalizeMeta(saved.meta));
            if (saved.answers) {
              const merged = createDefaultAnswers();
              Object.entries(saved.answers).forEach(([id, value]) => {
                merged[id] = {
                  ...merged[id],
                  ...value,
                };
              });
              setAnswers(merged);
            }
            if (saved.lang && I18N[saved.lang]) setLang(saved.lang);
          } catch (e) {
            console.warn("No previous data", e);
          }
        }, []);

        useEffect(() => {
          const payload = { meta, answers, lang };
          localStorage.setItem(
            "nist-csf-questionnaire-v1",
            JSON.stringify(payload)
          );
        }, [meta, answers, lang]);

        const filteredQuestions = useMemo(() => {
          const s = search.toLowerCase();
          return QUESTIONS.filter((q) => {
            const matchesFunction =
              functionFilter === "ALL" || q.fn === functionFilter;
            if (!matchesFunction) return false;

            const matchesCategory =
              !selectedCategories.length ||
              selectedCategories.includes(q.category);
            if (!matchesCategory) return false;

            const questionDepartments = q.departments || [];
            const matchesDepartment =
              selectedDepartments.length === 0 ||
              questionDepartments.some((deptId) =>
                selectedDepartments.includes(deptId)
              );
            if (!matchesDepartment) return false;

            if (!s) return true;

            const text = (q[lang] || "").toLowerCase();
            const deptText = questionDepartments
              .map(
                (deptId) =>
                  (DEPARTMENT_LOOKUP[deptId]?.[lang] || deptId).toLowerCase()
              )
              .join(" ");
            return (
              q.id.toLowerCase().includes(s) ||
              q.category.toLowerCase().includes(s) ||
              text.includes(s) ||
              deptText.includes(s)
            );
          });
        }, [
          search,
          lang,
          functionFilter,
          selectedCategories,
          selectedDepartments,
        ]);

        const stats = useMemo(() => {
          const byFn = {};
          FUNCTIONS.forEach((fn) => {
            byFn[fn.id] = { scores: [], targets: [] };
          });

          QUESTIONS.forEach((q) => {
            const a = answers[q.id];
            if (!a) return;
            if (typeof a.score === "number")
              byFn[q.fn].scores.push(a.score);
            if (typeof a.target === "number")
              byFn[q.fn].targets.push(a.target);
          });

          const radarData = FUNCTIONS.map((fn) => ({
            function: fn[lang],
            current: avg(byFn[fn.id].scores),
            target: avg(byFn[fn.id].targets),
          }));

          const allScores = QUESTIONS.map((q) => answers[q.id]?.score);
          const allTargets = QUESTIONS.map((q) => answers[q.id]?.target);
          const global = avg(allScores);
          const targetGlobal = avg(allTargets);

          return { byFn, radarData, global, targetGlobal };
        }, [answers, lang]);

        const maturityByFunctionData = useMemo(
          () =>
            FUNCTIONS.map((fn) => {
              const entry = stats.byFn[fn.id] || { scores: [], targets: [] };
              const value = avg(entry.scores);
              const target = avg(entry.targets);
              const targetGap = Math.max(0, target - value);
              return {
                id: fn.id,
                name: fn[lang],
                value,
                target,
                targetGap,
              };
            }),
          [lang, stats]
        );

        const hasScores = QUESTIONS.some(
          (q) => typeof answers[q.id]?.score === "number"
        );
        const hasTargets = QUESTIONS.some(
          (q) => typeof answers[q.id]?.target === "number"
        );
        const hasData = hasScores || hasTargets;
        const showTargetBars = maturityByFunctionData.some(
          (item) => item.targetGap > 0
        );

        const handleReset = useCallback(() => {
          if (!window.confirm(t.confirmReset)) return;

          setMeta({ project: "", assessor: "", org: "", date: "" });
          setAnswers(createDefaultAnswers());
          setSearch("");
          setFunctionFilter("ALL");
          setSelectedCategories([...ALL_CATEGORIES]);
          setSelectedDepartments([]);
          setInfoExpanded({});
        }, [t]);

        const handleToggleInfo = useCallback((id) => {
          setInfoExpanded((prev) => ({ ...prev, [id]: !prev[id] }));
        }, []);

        useEffect(() => {
          if (functionFilter === "ALL") {
            setSelectedCategories([...ALL_CATEGORIES]);
            return;
          }
          setSelectedCategories([
            ...(FUNCTION_CATEGORIES[functionFilter] || []),
          ]);
        }, [functionFilter]);

        const categoryOptions = useMemo(() => {
          if (functionFilter === "ALL") return ALL_CATEGORIES;
          return FUNCTION_CATEGORIES[functionFilter] || [];
        }, [functionFilter]);

        const handleCategoryClick = useCallback(
          (categoryId) => {
            setSelectedCategories((prev) => {
              if (prev.length === 1 && prev[0] === categoryId) {
                if (functionFilter === "ALL") {
                  return [...ALL_CATEGORIES];
                }
                return [...(FUNCTION_CATEGORIES[functionFilter] || [])];
              }
              return [categoryId];
            });
          },
          [functionFilter]
        );

        const resetCategoriesToDefault = useCallback(() => {
          if (functionFilter === "ALL") {
            setSelectedCategories([...ALL_CATEGORIES]);
            return;
          }
          setSelectedCategories([...(FUNCTION_CATEGORIES[functionFilter] || [])]);
        }, [functionFilter]);

        const handleDepartmentClick = useCallback((deptId) => {
          setSelectedDepartments((prev) => {
            if (prev.includes(deptId)) {
              return prev.filter((id) => id !== deptId);
            }
            return [...prev, deptId];
          });
        }, []);

        const resetDepartmentsToAll = useCallback(() => {
          setSelectedDepartments([]);
        }, []);

        const handleExportCSV = useCallback(() => {
          const header = [
            "ID",
            t.functionColumn,
            t.categoryColumn,
            t.questions,
            t.score,
            t.target,
            t.comments,
          ];

          const csvRows = QUESTIONS.map((q) => {
            const fn = FUNCTIONS.find((f) => f.id === q.fn);
            const a = answers[q.id] || {};
            const clean = (value) =>
              (value ?? "")
                .toString()
                .replace(/"/g, '""')
                .replace(/\r?\n|\r/g, " ");

            return [
              q.id,
              fn ? fn[lang] : q.fn,
              q.category,
              q[lang],
              a.score ?? "",
              a.target ?? "",
              clean(a.comments || ""),
            ].map((value) => `"${clean(value)}"`).join(";");
          });

          const csvContent = [header.map((value) => `"${value}"`).join(";"), ...csvRows].join("\n");
          const blob = new Blob([csvContent], {
            type: "text/csv;charset=utf-8;",
          });
          const url = URL.createObjectURL(blob);
          const link = document.createElement("a");
          link.href = url;
          link.download = `nist-csf-questionnaire_${lang}.csv`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(url);
        }, [answers, lang, t]);

        const handleExportJSON = useCallback(() => {
          const payload = {
            meta,
            answers,
            lang,
          };
          const blob = new Blob([JSON.stringify(payload, null, 2)], {
            type: "application/json",
          });
          const url = URL.createObjectURL(blob);
          const link = document.createElement("a");
          link.href = url;
          link.download = `nist-csf-questionnaire_${lang}.json`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(url);
        }, [answers, lang, meta]);

        const handleExportPDF = useCallback(() => {
          if (!window.jspdf || !window.jspdf.jsPDF) {
            console.warn("jsPDF unavailable");
            return;
          }

          const doc = new window.jspdf.jsPDF({
            orientation: "portrait",
            unit: "pt",
            format: "a4",
          });

          const pageWidth = doc.internal.pageSize.getWidth();
          const pageHeight = doc.internal.pageSize.getHeight();
          const margin = 40;
          let y = margin;

          doc.setFontSize(16);
          doc.text(t.appTitle, margin, y);
          y += 24;

          doc.setFontSize(10);
          const metaEntries = [
            [t.project, meta.project],
            [t.assessor, meta.assessor],
            [t.org, meta.org],
            [t.date, meta.date],
          ];

          metaEntries.forEach(([label, value]) => {
            doc.text(`${label}: ${value || "-"}`, margin, y);
            y += 14;
          });

          y += 10;

          const addPageIfNeeded = (spaceNeeded = 0) => {
            if (y + spaceNeeded <= pageHeight - margin) return;
            doc.addPage();
            y = margin;
          };

          doc.setFont("helvetica", "bold");
          doc.setFontSize(14);
          doc.text(t.dashboard, margin, y);
          y += 18;

          doc.setFont("helvetica", "normal");
          doc.setFontSize(11);

          if (hasData) {
            const globalScoreText = `${t.maturityScore}: ${
              hasScores ? stats.global.toFixed(2) : "-"
            }`;
            const targetScoreText = `${t.maturityTarget}: ${
              hasTargets ? stats.targetGlobal.toFixed(2) : "-"
            }`;

            [globalScoreText, targetScoreText].forEach((line) => {
              const wrapped = doc.splitTextToSize(
                line,
                pageWidth - margin * 2
              );
              addPageIfNeeded(wrapped.length * 14);
              doc.text(wrapped, margin, y);
              y += wrapped.length * 14;
            });

            y += 6;
            doc.setFont("helvetica", "bold");
            doc.text(t.maturityByFn, margin, y);
            y += 16;
            doc.setFont("helvetica", "normal");

            FUNCTIONS.forEach((fn) => {
              const fnScores = stats.byFn[fn.id]?.scores || [];
              const fnTargets = stats.byFn[fn.id]?.targets || [];
              const hasFnScores = fnScores.length > 0;
              const hasFnTargets = fnTargets.length > 0;
              const line = `${fn[lang]} – ${t.score}: ${
                hasFnScores ? avg(fnScores).toFixed(2) : "-"
              } | ${t.target}: ${
                hasFnTargets ? avg(fnTargets).toFixed(2) : "-"
              }`;
              const wrapped = doc.splitTextToSize(
                line,
                pageWidth - margin * 2
              );
              addPageIfNeeded(wrapped.length * 14);
              doc.text(wrapped, margin, y);
              y += wrapped.length * 14;
            });
          } else {
            const noDataLines = doc.splitTextToSize(
              t.noDataYet,
              pageWidth - margin * 2
            );
            addPageIfNeeded(noDataLines.length * 14);
            doc.text(noDataLines, margin, y);
            y += noDataLines.length * 14;
          }

          y += 18;
          doc.setFont("helvetica", "bold");
          doc.setFontSize(14);
          doc.text(t.questions, margin, y);
          y += 18;

          QUESTIONS.forEach((q) => {
            const fn = FUNCTIONS.find((f) => f.id === q.fn);
            const a = answers[q.id] || {};

            addPageIfNeeded(80);

            doc.setFont("helvetica", "bold");
            doc.setFontSize(12);
            doc.text(`${q.id} – ${fn ? fn[lang] : q.fn}`, margin, y);
            y += 16;

            doc.setFont("helvetica", "normal");
            const questionLines = doc.splitTextToSize(q[lang], pageWidth - margin * 2);
            doc.text(questionLines, margin, y);
            y += questionLines.length * 14;

            const details = [
              `${t.score}: ${typeof a.score === "number" ? a.score : "-"}`,
              `${t.target}: ${typeof a.target === "number" ? a.target : "-"}`,
              `${t.comments}: ${a.comments ? a.comments.replace(/\r?\n|\r/g, " ") : "-"}`,
            ];

            details.forEach((line) => {
              addPageIfNeeded(20);
              const wrapped = doc.splitTextToSize(line, pageWidth - margin * 2);
              doc.text(wrapped, margin, y);
              y += wrapped.length * 14;
            });

            y += 10;
          });

          doc.save(`nist-csf-questionnaire_${lang}.pdf`);
        }, [answers, hasData, hasScores, hasTargets, lang, meta, stats, t]);

        const handleImportJSONClick = useCallback(() => {
          if (fileInputRef.current) {
            fileInputRef.current.click();
          }
        }, []);

        const handleImportJSON = useCallback(
          (event) => {
            const input = event.target;
            const file = input.files && input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = () => {
              try {
                const text = reader.result || "";
                const parsed = JSON.parse(text);

                if (!parsed || typeof parsed !== "object") {
                  throw new Error("Invalid JSON structure");
                }

                const nextMeta = normalizeMeta(parsed.meta);

                if (!parsed.answers || typeof parsed.answers !== "object") {
                  throw new Error("Missing answers");
                }

                const merged = createDefaultAnswers();
                Object.entries(parsed.answers).forEach(([id, value]) => {
                  if (merged[id]) {
                    merged[id] = {
                      ...merged[id],
                      ...value,
                    };
                  }
                });

                const nextLang =
                  parsed.lang && I18N[parsed.lang] ? parsed.lang : null;

                setMeta(nextMeta);
                setAnswers(merged);
                if (nextLang) {
                  setLang(nextLang);
                }

                window.alert(t.importJsonSuccess);
              } catch (error) {
                console.error("JSON import failed", error);
                window.alert(t.importJsonError);
              } finally {
                input.value = "";
              }
            };
            reader.onerror = () => {
              console.error("File reading error", reader.error);
              window.alert(t.importJsonError);
              input.value = "";
            };
            reader.readAsText(file);
          },
          [setAnswers, setLang, setMeta, t]
        );

        return html`
          <div className="min-h-screen bg-neutral-50 py-6 px-3 md:px-6">
            <div className="max-w-6xl mx-auto">
              <header className="mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                <div>
                  <h1 className="text-2xl md:text-3xl font-bold text-neutral-900">
                    ${t.appTitle}
                  </h1>
                  <p className="text-sm text-neutral-600 mt-1">
                    ${t.cmmiInfo}
                  </p>
                </div>
                <div className="flex items-center gap-2 self-start md:self-auto">
                  <span className="text-sm text-neutral-600">
                    ${t.globalLang}
                  </span>
                  <button
                    className="px-3 py-1 rounded-full border text-sm bg-white border-neutral-300 hover:border-blue-500 hover:text-blue-600"
                    onClick=${() => setLang(lang === "fr" ? "en" : "fr")}
                  >
                    ${lang === "fr" ? "EN 🇬🇧" : "FR 🇫🇷"}
                  </button>
                </div>
              </header>

              <div
                className="mb-6 flex flex-col gap-3 md:flex-row md:items-center md:justify-between"
              >
                <div className="flex flex-wrap gap-2">
                  <button
                    className="inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-red-200 bg-white text-sm font-medium text-red-600 hover:border-red-400 hover:text-red-700 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-1"
                    onClick=${handleReset}
                    type="button"
                  >
                    🔄 ${t.resetForm}
                  </button>
                  <button
                    className="inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-neutral-300 bg-white text-sm font-medium text-neutral-700 hover:border-blue-500 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1"
                    onClick=${handleExportCSV}
                    type="button"
                  >
                    📄 ${t.exportCsv}
                  </button>
                  <button
                    className="inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-neutral-300 bg-white text-sm font-medium text-neutral-700 hover:border-blue-500 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1"
                    onClick=${handleExportPDF}
                    type="button"
                  >
                    🧾 ${t.exportPdf}
                  </button>
                  <button
                    className="inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-neutral-300 bg-white text-sm font-medium text-neutral-700 hover:border-blue-500 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1"
                    onClick=${handleExportJSON}
                    type="button"
                  >
                    🗂️ ${t.exportJson}
                  </button>
                  <button
                    className="inline-flex items-center gap-2 px-3 py-2 rounded-lg border border-neutral-300 bg-white text-sm font-medium text-neutral-700 hover:border-blue-500 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1"
                    onClick=${handleImportJSONClick}
                    type="button"
                  >
                    📥 ${t.importJson}
                  </button>
                  <input
                    ref=${fileInputRef}
                    type="file"
                    accept="application/json,.json"
                    className="hidden"
                    onChange=${handleImportJSON}
                  />
                </div>
                <div className="text-xs text-neutral-500 space-y-1">
                  <p>${t.tips1}</p>
                  <p>${t.tips2}</p>
                </div>
              </div>

              <!-- Métadonnées -->
              <${Card} title=${t.meta}>
                <div className="grid grid-cols-1 md:grid-cols-4 gap-3">
                  <${TextInput}
                    label=${t.project}
                    value=${meta.project}
                    onChange=${(v) => setMeta({ ...meta, project: v })}
                  />
                  <${TextInput}
                    label=${t.assessor}
                    value=${meta.assessor}
                    onChange=${(v) => setMeta({ ...meta, assessor: v })}
                  />
                  <${TextInput}
                    label=${t.org}
                    value=${meta.org}
                    onChange=${(v) => setMeta({ ...meta, org: v })}
                  />
                  <${TextInput}
                    label=${t.date}
                    type="date"
                    value=${meta.date}
                    onChange=${(v) => setMeta({ ...meta, date: v })}
                  />
                </div>
              <//>

              <!-- Dashboard -->
              <${Card} title=${t.dashboard}>
                ${hasData
                  ? html`
                      <div
                        className="grid grid-cols-1 lg:grid-cols-3 gap-4 items-start"
                      >
                        <div className="space-y-3">
                          <div
                            className="rounded-xl bg-blue-50 border border-blue-100 p-4"
                          >
                            <div
                              className="text-xs uppercase font-semibold text-blue-600 tracking-wide"
                            >
                              ${t.maturityScore}
                            </div>
                            <div
                              className="mt-2 text-3xl font-bold text-blue-900"
                            >
                              ${stats.global.toFixed(2)}
                            </div>
                            <div className="mt-1 text-xs text-blue-900/70">
                              (0–5)
                            </div>
                            <div className="mt-4 pt-3 border-t border-blue-100">
                              <div
                                className="text-xs uppercase font-semibold text-blue-600 tracking-wide"
                              >
                                ${t.maturityTarget}
                              </div>
                              <div
                                className="mt-2 text-2xl font-semibold text-blue-900"
                              >
                                ${stats.targetGlobal.toFixed(2)}
                              </div>
                              <div className="mt-1 text-xs text-blue-900/70">
                                ${t.targetInfo}
                              </div>
                            </div>
                          </div>

                          <div className="text-xs text-neutral-500 space-y-1">
                            <p>${t.tips1}</p>
                            <p>${t.tips2}</p>
                          </div>
                        </div>

                        <div className="lg:col-span-2 h-64">
                          <${ResponsiveContainer} width="100%" height="100%">
                            <${BarChart}
                              data=${maturityByFunctionData}
                            >
                              <${CartesianGrid} strokeDasharray="3 3" />
                              <${XAxis} dataKey="name" />
                              <${YAxis} domain=${[0, 5]} />
                              <${Tooltip}
                                formatter=${(value, name, props) => {
                                  if (props?.dataKey === "targetGap") {
                                    const target = props?.payload?.target;
                                    if (typeof target === "number") {
                                      return [target.toFixed(2), name];
                                    }
                                  }
                                  if (typeof value === "number") {
                                    return [value.toFixed(2), name];
                                  }
                                  return [value, name];
                                }}
                              />
                              <${Bar}
                                dataKey="value"
                                name=${t.maturityCurrent}
                                radius=${[6, 6, 0, 0]}
                                stackId="maturity"
                              >
                                ${maturityByFunctionData.map(
                                  (item) =>
                                    html`<${Cell}
                                      key=${item.id}
                                      fill=${FUNCTION_COLORS[item.id]}
                                    />`
                                )}
                              <//>
                              ${
                                showTargetBars &&
                                html`<${Bar}
                                  dataKey="targetGap"
                                  name=${t.maturityTargetLabel}
                                  shape=${TargetBarShape}
                                  isAnimationActive=${false}
                                  legendType="none"
                                  fill="transparent"
                                  stackId="maturity"
                                >
                                  ${maturityByFunctionData.map(
                                    (item) =>
                                      html`<${Cell}
                                        key=${`${item.id}-target`}
                                        fill=${FUNCTION_COLORS[item.id]}
                                      />`
                                  )}
                                <//>`
                              }
                            <//>
                          <//>
                          <p className="mt-2 text-xs text-neutral-500">
                            ${t.maturityByFn}
                          </p>
                        </div>
                      </div>

                      <div className="mt-6 h-72">
                        <${ResponsiveContainer} width="100%" height="100%">
                          <${RChart} data=${stats.radarData}>
                            <${PolarGrid} />
                            <${PolarAngleAxis} dataKey="function" />
                            <${PolarRadiusAxis} domain=${[0, 5]} />
                            <${RadarShape}
                              name="Current"
                              dataKey="current"
                              fill="#2563EB"
                              fillOpacity=${0.4}
                              stroke="#2563EB"
                            />
                            <${RadarShape}
                              name="Target"
                              dataKey="target"
                              fill="#F97316"
                              fillOpacity=${0.2}
                              stroke="#F97316"
                              strokeDasharray="4 4"
                            />
                            <${Legend} />
                          <//>
                        <//>
                        <p className="mt-2 text-xs text-neutral-500">
                          ${t.radarTitle}
                        </p>
                      </div>
                    `
                  : html`
                      <p className="text-sm text-neutral-500">
                        ${t.noDataYet}
                      </p>
                    `}
              <//>

              <!-- Questions -->
              <${Card} title=${t.questions}>
                <div className="flex flex-col gap-4 mb-3">
                  <div>
                    <div className="text-xs font-semibold uppercase text-neutral-500 tracking-wide mb-2">
                      ${t.filterByFunction}
                    </div>
                    <div className="flex items-center gap-2 overflow-x-auto pb-1 -mx-1 px-1">
                      <button
                        className="shrink-0 inline-flex items-center px-3 py-1.5 rounded-full border text-xs font-medium transition focus:outline-none focus:ring-2 focus:ring-offset-0 focus:ring-blue-500"
                        style=${{
                          backgroundColor:
                            functionFilter === "ALL" ? "#1F2937" : "white",
                          color: functionFilter === "ALL" ? "white" : "#374151",
                          borderColor:
                            functionFilter === "ALL" ? "#1F2937" : "#D1D5DB",
                        }}
                        onClick=${() => setFunctionFilter("ALL")}
                      >
                        ${t.allFunctions}
                      </button>
                      ${FUNCTIONS.map((fn) => {
                        const isActive = functionFilter === fn.id;
                        const activeStyles = {
                          backgroundColor: FUNCTION_COLORS[fn.id],
                          color: "white",
                          borderColor: FUNCTION_COLORS[fn.id],
                        };
                        const inactiveStyles = {
                          backgroundColor: FUNCTION_COLORS[fn.id] + "14",
                          color: FUNCTION_COLORS[fn.id],
                          borderColor: FUNCTION_COLORS[fn.id] + "40",
                        };
                        return html`
                          <button
                            key=${fn.id}
                            className="shrink-0 inline-flex items-center px-3 py-1.5 rounded-full border text-xs font-semibold uppercase tracking-wide transition focus:outline-none focus:ring-2 focus:ring-offset-0 focus:ring-blue-500"
                            style=${isActive ? activeStyles : inactiveStyles}
                            title=${fn[lang]}
                            onClick=${() =>
                              setFunctionFilter((prev) =>
                                prev === fn.id ? "ALL" : fn.id
                              )}
                          >
                            ${(fn[lang] || fn.id).toUpperCase()}
                          </button>
                        `;
                      })}
                    </div>
                  </div>

                  <div>
                    <div className="text-xs font-semibold uppercase text-neutral-500 tracking-wide mb-2">
                      ${t.filterByCategory}
                    </div>
                    <div className="flex items-center gap-2 overflow-x-auto pb-1 -mx-1 px-1">
                      <button
                        className="shrink-0 inline-flex items-center px-3 py-1.5 rounded-full border text-xs font-medium transition focus:outline-none focus:ring-2 focus:ring-offset-0 focus:ring-blue-500"
                        style=${{
                          backgroundColor: "#1F2937",
                          color: "white",
                          borderColor: "#1F2937",
                        }}
                        onClick=${resetCategoriesToDefault}
                        type="button"
                      >
                        ${t.allCategories}
                      </button>
                      ${categoryOptions.map((categoryId) => {
                        const fnId = CATEGORY_TO_FUNCTION[categoryId];
                        const baseColor = FUNCTION_COLORS[fnId] || "#1F2937";
                        const isActive = selectedCategories.includes(categoryId);
                        const activeStyles = {
                          backgroundColor: baseColor,
                          color: "white",
                          borderColor: baseColor,
                        };
                        const inactiveStyles = {
                          backgroundColor: baseColor + "14",
                          color: baseColor,
                          borderColor: baseColor + "40",
                        };
                        return html`
                          <button
                            key=${categoryId}
                            className="shrink-0 inline-flex items-center px-3 py-1.5 rounded-full border text-xs font-semibold uppercase tracking-wide transition focus:outline-none focus:ring-2 focus:ring-offset-0 focus:ring-blue-500"
                            style=${isActive ? activeStyles : inactiveStyles}
                            onClick=${() => handleCategoryClick(categoryId)}
                            type="button"
                          >
                            ${categoryId}
                          </button>
                        `;
                      })}
                    </div>
                  </div>

                  <div>
                    <div className="text-xs font-semibold uppercase text-neutral-500 tracking-wide mb-2">
                      ${t.filterByDepartment}
                    </div>
                    <div className="flex items-center gap-2 overflow-x-auto pb-1 -mx-1 px-1">
                      <button
                        className="shrink-0 inline-flex items-center px-3 py-1.5 rounded-full border text-xs font-medium transition focus:outline-none focus:ring-2 focus:ring-offset-0 focus:ring-blue-500"
                        style=${{
                          backgroundColor: "#111827",
                          color: "white",
                          borderColor: "#111827",
                        }}
                        onClick=${resetDepartmentsToAll}
                        type="button"
                      >
                        ${t.allDepartments}
                      </button>
                      ${DEPARTMENTS.map((dept) => {
                        const isActive = selectedDepartments.includes(dept.id);
                        const activeStyles = {
                          backgroundColor: "#0F172A",
                          color: "white",
                          borderColor: "#0F172A",
                        };
                        const inactiveStyles = {
                          backgroundColor: "#F3F4F6",
                          color: "#111827",
                          borderColor: "#E5E7EB",
                        };
                        return html`
                          <button
                            key=${dept.id}
                            className="shrink-0 inline-flex items-center px-3 py-1.5 rounded-full border text-xs font-medium transition focus:outline-none focus:ring-2 focus:ring-offset-0 focus:ring-blue-500"
                            style=${isActive ? activeStyles : inactiveStyles}
                            onClick=${() => handleDepartmentClick(dept.id)}
                            type="button"
                            title=${dept[lang]}
                          >
                            ${dept.id}
                          </button>
                        `;
                      })}
                    </div>
                  </div>

                  <div className="flex flex-col md:flex-row md:items-center gap-3">
                    <input
                      className="w-full md:w-80 rounded-lg border border-neutral-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                      placeholder=${t.searchPh}
                      value=${search}
                      onChange=${(e) => setSearch(e.target.value)}
                    />
                  </div>
                </div>

                <div className="overflow-x-auto">
                  <table className="min-w-full text-sm border-t border-neutral-200">
                    <thead className="text-xs uppercase bg-neutral-100 text-neutral-700">
                      <tr>
                        <th className="px-3 py-2 text-left">${t.functionColumn}</th>
                        <th className="px-3 py-2 text-left">${t.categoryColumn}</th>
                        <th className="px-3 py-2 text-left">ID</th>
                        <th className="px-3 py-2 text-left">${lang === "fr" ? "Question" : "Question"}</th>
                        <th className="px-3 py-2 text-center w-16">
                          <span className="sr-only">${t.infoLabel}</span>
                        </th>
                        <th className="px-3 py-2 text-left w-24">${t.score}</th>
                        <th className="px-3 py-2 text-left w-24">${t.target}</th>
                      </tr>
                    </thead>
                    <tbody>
                      ${filteredQuestions.map((q) => {
                        const fn = FUNCTIONS.find((f) => f.id === q.fn);
                        const a = answers[q.id] || {};
                        const detailText = lang === "fr" ? q.detailFr : q.detailEn;
                        const expanded = infoExpanded[q.id];
                        const questionDepartments = q.departments || [];
                        return html`
                          <${React.Fragment} key=${q.id}>
                            <tr className="border-t border-neutral-200 align-top">
                              <td className="px-3 py-3 text-xs font-semibold">
                                <span
                                  className="px-2 py-1 rounded-full text-[11px]"
                                  style=${{
                                    backgroundColor: FUNCTION_COLORS[q.fn] + "20",
                                    color: FUNCTION_COLORS[q.fn],
                                  }}
                                >
                                  ${fn ? fn[lang] : q.fn}
                                </span>
                              </td>
                              <td className="px-3 py-3 text-xs text-neutral-600">
                                ${q.category}
                              </td>
                              <td className="px-3 py-3 font-mono text-xs text-neutral-600">
                                ${q.id}
                              </td>
                              <td className="px-3 py-3 text-sm text-neutral-800">
                                <div>${q[lang]}</div>
                                ${detailText && expanded
                                  ? html`<p
                                      className="mt-2 rounded-lg border border-blue-100 bg-blue-50 px-3 py-2 text-xs text-blue-900"
                                      dangerouslySetInnerHTML=${{ __html: detailText }}
                                    />`
                                  : null}
                                ${questionDepartments.length
                                  ? html`<div className="mt-3">
                                      <div
                                        className="text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-1"
                                      >
                                        ${t.responsibleDepartmentsLabel}
                                      </div>
                                      <div className="flex flex-wrap gap-1.5">
                                        ${questionDepartments.map((deptId) => {
                                          const dept = DEPARTMENT_LOOKUP[deptId] || {};
                                          return html`<span
                                            key=${deptId}
                                            className="inline-flex items-center rounded-full border border-neutral-200 bg-neutral-100 px-2 py-0.5 text-[11px] font-medium text-neutral-700"
                                          >
                                            ${dept[lang] || deptId}
                                          </span>`;
                                        })}
                                      </div>
                                    </div>`
                                  : null}
                              </td>
                              <td className="px-3 py-3 text-center align-middle">
                                ${detailText
                                  ? html`<button
                                      type="button"
                                      className="inline-flex h-7 w-7 items-center justify-center rounded-full border border-blue-200 bg-blue-50 text-xs font-semibold text-blue-700 hover:border-blue-300 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-400"
                                      title=${t.infoLabel}
                                      aria-label=${t.infoLabel}
                                      aria-expanded=${expanded ? "true" : "false"}
                                      onClick=${() => handleToggleInfo(q.id)}
                                    >
                                      i
                                    </button>`
                                  : html`<span className="text-neutral-300">–</span>`}
                              </td>
                              <td className="px-3 py-3">
                                <${SelectScore}
                                  value=${a.score}
                                  onChange=${(v) =>
                                    setAnswers({
                                      ...answers,
                                      [q.id]: { ...a, score: v },
                                    })}
                                />
                              </td>
                              <td className="px-3 py-3">
                                <${SelectScore}
                                  value=${a.target}
                                  onChange=${(v) =>
                                    setAnswers({
                                      ...answers,
                                      [q.id]: { ...a, target: v },
                                    })}
                                />
                              </td>
                            </tr>
                              <tr className="border-b border-neutral-200">
                                <td className="px-3 pb-4 pt-0" colSpan="7">
                                <div className="flex flex-col gap-2">
                                  <div className="text-xs font-medium text-neutral-600">
                                    ${t.comments}
                                  </div>
                                  <textarea
                                    className="w-full rounded-md border border-neutral-300 px-2 py-2 text-xs focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    rows="2"
                                    value=${a.comments || ""}
                                    onChange=${(e) =>
                                      setAnswers({
                                        ...answers,
                                        [q.id]: {
                                          ...a,
                                          comments: e.target.value,
                                        },
                                      })}
                                  ></textarea>
                                </div>
                              </td>
                            </tr>
                          <//>
                        `;
                      })}
                    </tbody>
                  </table>
                </div>
              <//>

              <p className="mt-4 text-xs text-neutral-400">
                ${t.tips1}
              </p>
            </div>
          </div>
        `;
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(html`<${NistCsfQuestionnaire} />`);
    </script>
  </body>
</html>
